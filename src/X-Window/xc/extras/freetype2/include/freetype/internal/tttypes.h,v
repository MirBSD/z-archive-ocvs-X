head	1.2;
branch	1.1.1;
access;
symbols
	tg-mergetmp-2:1.1.1.3
	cvs-200410241530:1.1.1.3
	cvs-200410012000:1.1.1.3
	cvs-200407141120:1.1.1.3
	cvs-200406231010:1.1.1.3
	MIRBSD_7quater:1.1.1.2
	cvs-200405271510:1.1.1.3
	XFree86_4_4_0:1.1.9.1
	cvs-200403021700:1.1.1.3
	XFREE86_20040213:1.1.9.1
	xc:1.1.9
	cvs-200401291925:1.1.1.2
	MIRBSD_7_ALPHA:1.1.1.2.0.4
	MIRBSD_7:1.1.1.2.0.2
	MIRBSD_7ter:1.1.1.2
	cvs-20011091815:1.1.1.2
	cvs-200309162130:1.1.1.2
	cvs-200308302005:1.1.1.2
	ctmx-0387:1.1.1.2
	ctmx-0384:1.1.1.2
	MIRBSD_5:1.1.1.2
	ctmx-0375:1.1.1.2
	ctmx-0373:1.1.1.2
	ctm-0371:1.1.1.2
	ctm-0370:1.1.1.2
	MIRBSD_4:1.1.1.2
	ctm-0363:1.1.1.2
	ctm-0359:1.1.1.2
	ctm-0349:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@ * @;


1.2
date	2003.05.16.16.29.41;	author tg;	state dead;
branches;
next	1.1;

1.1
date	2003.03.22.20.01.19;	author tg;	state Exp;
branches
	1.1.1.1
	1.1.9.1;
next	;

1.1.1.1
date	2003.03.22.20.01.19;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.04.08.18.20.55;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2004.03.02.17.38.00;	author tg;	state Stab;
branches;
next	;

1.1.9.1
date	2004.02.14.19.08.51;	author tg;	state Exp;
branches;
next	;


desc
@@


1.2
log
@remove a bunch of files not used in MirBSD - clean tree. People who want them got cvs.
@
text
@/***************************************************************************/
/*                                                                         */
/*  tttypes.h                                                              */
/*                                                                         */
/*    Basic SFNT/TrueType type definitions and interface (specification    */
/*    only).                                                               */
/*                                                                         */
/*  Copyright 1996-2001 by                                                 */
/*  David Turner, Robert Wilhelm, and Werner Lemberg.                      */
/*                                                                         */
/*  This file is part of the FreeType project, and may only be used,       */
/*  modified, and distributed under the terms of the FreeType project      */
/*  license, LICENSE.TXT.  By continuing to use, modify, or distribute     */
/*  this file you indicate that you have read the license and              */
/*  understand and accept it fully.                                        */
/*                                                                         */
/***************************************************************************/


#ifndef __TTTYPES_H__
#define __TTTYPES_H__


#include <ft2build.h>
#include FT_TRUETYPE_TABLES_H
#include FT_INTERNAL_OBJECTS_H


FT_BEGIN_HEADER


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***             REQUIRED TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TTC_Header                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    TrueType collection header.  This table contains the offsets of    */
  /*    the font headers of each distinct TrueType face in the file.       */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    tag     :: Must be `ttc ' to indicate a TrueType collection.       */
  /*                                                                       */
  /*    version :: The version number.                                     */
  /*                                                                       */
  /*    count   :: The number of faces in the collection.  The             */
  /*               specification says this should be an unsigned long, but */
  /*               we use a signed long since we need the value -1 for     */
  /*               specific purposes.                                      */
  /*                                                                       */
  /*    offsets :: The offsets of the font headers, one per face.          */
  /*                                                                       */
  typedef struct  TTC_Header_
  {
    FT_ULong   tag;
    FT_Fixed   version;
    FT_Long    count;
    FT_ULong*  offsets;

  } TTC_Header;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    SFNT_Header                                                        */
  /*                                                                       */
  /* <Description>                                                         */
  /*    SFNT file format header.                                           */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    format_tag     :: The font format tag.                             */
  /*                                                                       */
  /*    num_tables     :: The number of tables in file.                    */
  /*                                                                       */
  /*    search_range   :: Must be 16*(max power of 2 <= num_tables).       */
  /*                                                                       */
  /*    entry_selector :: Must be log2 of search_range/16.                 */
  /*                                                                       */
  /*    range_shift    :: Must be num_tables*16 - search_range.            */
  /*                                                                       */
  typedef struct  SFNT_Header_
  {
    FT_ULong   format_tag;
    FT_UShort  num_tables;
    FT_UShort  search_range;
    FT_UShort  entry_selector;
    FT_UShort  range_shift;

  } SFNT_Header;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_TableDir                                                        */
  /*                                                                       */
  /* <Description>                                                         */
  /*    This structure models a TrueType table directory.  It is used to   */
  /*    access the various tables of the font face.                        */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    version       :: The version number; starts with 0x00010000.       */
  /*                                                                       */
  /*    numTables     :: The number of tables.                             */
  /*                                                                       */
  /*    searchRange   :: Unused.                                           */
  /*                                                                       */
  /*    entrySelector :: Unused.                                           */
  /*                                                                       */
  /*    rangeShift    :: Unused.                                           */
  /*                                                                       */
  /* <Note>                                                                */
  /*    This structure is only used during font opening.                   */
  /*                                                                       */
  typedef struct  TT_TableDir_
  {
    FT_Fixed   version;        /* should be 0x10000 */
    FT_UShort  numTables;      /* number of tables  */

    FT_UShort  searchRange;    /* These parameters are only used  */
    FT_UShort  entrySelector;  /* for a dichotomy search in the   */
    FT_UShort  rangeShift;     /* directory.  We ignore them.     */

  } TT_TableDir;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Table                                                           */
  /*                                                                       */
  /* <Description>                                                         */
  /*    This structure describes a given table of a TrueType font.         */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    Tag      :: A four-bytes tag describing the table.                 */
  /*                                                                       */
  /*    CheckSum :: The table checksum.  This value can be ignored.        */
  /*                                                                       */
  /*    Offset   :: The offset of the table from the start of the TrueType */
  /*                font in its resource.                                  */
  /*                                                                       */
  /*    Length   :: The table length (in bytes).                           */
  /*                                                                       */
  typedef struct  TT_Table_
  {
    FT_ULong  Tag;        /*        table type */
    FT_ULong  CheckSum;   /*    table checksum */
    FT_ULong  Offset;     /* table file offset */
    FT_ULong  Length;     /*      table length */

  } TT_Table;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_CMapDir                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    This structure describes the directory of the `cmap' table,        */
  /*    containing the font's character mappings table.                    */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    tableVersionNumber :: The version number.                          */
  /*                                                                       */
  /*    numCMaps           :: The number of charmaps in the font.          */
  /*                                                                       */
  /* <Note>                                                                */
  /*    This structure is only used during font loading.                   */
  /*                                                                       */
  typedef struct  TT_CMapDir_
  {
    FT_UShort  tableVersionNumber;
    FT_UShort  numCMaps;

  } TT_CMapDir;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_CMapDirEntry                                                    */
  /*                                                                       */
  /* <Description>                                                         */
  /*    This structure describes a charmap in a TrueType font.             */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    platformID :: An ID used to specify for which platform this        */
  /*                  charmap is defined (FreeType manages all platforms). */
  /*                                                                       */
  /*    encodingID :: A platform-specific ID used to indicate which source */
  /*                  encoding is used in this charmap.                    */
  /*                                                                       */
  /*    offset     :: The offset of the charmap relative to the start of   */
  /*                  the `cmap' table.                                    */
  /*                                                                       */
  /* <Note>                                                                */
  /*    This structure is only used during font loading.                   */
  /*                                                                       */
  typedef struct  TT_CMapDirEntry_
  {
    FT_UShort  platformID;
    FT_UShort  platformEncodingID;
    FT_Long    offset;

  } TT_CMapDirEntry;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_LongMetrics                                                     */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure modeling the long metrics of the `hmtx' and `vmtx'     */
  /*    TrueType tables.  The values are expressed in font units.          */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    advance :: The advance width or height for the glyph.              */
  /*                                                                       */
  /*    bearing :: The left-side or top-side bearing for the glyph.        */
  /*                                                                       */
  typedef struct  TT_LongMetrics_
  {
    FT_UShort  advance;
    FT_Short   bearing;

  } TT_LongMetrics;


  /*************************************************************************/
  /*                                                                       */
  /* <Type> TT_ShortMetrics                                                */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A simple type to model the short metrics of the `hmtx' and `vmtx'  */
  /*    tables.                                                            */
  /*                                                                       */
  typedef FT_Short  TT_ShortMetrics;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_NameRec                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure modeling TrueType name records.  Name records are used */
  /*    to store important strings like family name, style name,           */
  /*    copyright, etc. in _localized_ versions (i.e., language, encoding, */
  /*    etc).                                                              */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    platformID   :: The ID of the name's encoding platform.            */
  /*                                                                       */
  /*    encodingID   :: The platform-specific ID for the name's encoding.  */
  /*                                                                       */
  /*    languageID   :: The platform-specific ID for the name's language.  */
  /*                                                                       */
  /*    nameID       :: The ID specifying what kind of name this is.       */
  /*                                                                       */
  /*    stringLength :: The length of the string in bytes.                 */
  /*                                                                       */
  /*    stringOffset :: The offset to the string in the `name' table.      */
  /*                                                                       */
  /*    string       :: A pointer to the string's bytes.  Note that these  */
  /*                    are usually UTF-16 encoded characters.             */
  /*                                                                       */
  typedef struct  TT_NameRec_
  {
    FT_UShort  platformID;
    FT_UShort  encodingID;
    FT_UShort  languageID;
    FT_UShort  nameID;
    FT_UShort  stringLength;
    FT_UShort  stringOffset;

    /* this last field is not defined in the spec */
    /* but used by the FreeType engine            */

    FT_Byte*   string;

  } TT_NameRec;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_NameTable                                                       */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure modeling the TrueType name table.                      */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    format         :: The format of the name table.                    */
  /*                                                                       */
  /*    numNameRecords :: The number of names in table.                    */
  /*                                                                       */
  /*    storageOffset  :: The offset of the name table in the `name'       */
  /*                      TrueType table.                                  */
  /*                                                                       */
  /*    names          :: An array of name records.                        */
  /*                                                                       */
  /*    storage        :: The names storage area.                          */
  /*                                                                       */
  typedef struct  TT_NameTable_
  {
    FT_UShort    format;
    FT_UShort    numNameRecords;
    FT_UShort    storageOffset;
    TT_NameRec*  names;
    FT_Byte*     storage;

  } TT_NameTable;


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***             OPTIONAL TRUETYPE/OPENTYPE TABLES DEFINITIONS         ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_GaspRange                                                       */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A tiny structure used to model a gasp range according to the       */
  /*    TrueType specification.                                            */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    maxPPEM  :: The maximum ppem value to which `gaspFlag' applies.    */
  /*                                                                       */
  /*    gaspFlag :: A flag describing the grid-fitting and anti-aliasing   */
  /*                modes to be used.                                      */
  /*                                                                       */
  typedef struct  TT_GaspRange_
  {
    FT_UShort  maxPPEM;
    FT_UShort  gaspFlag;

  } TT_GaspRange;


#define TT_GASP_GRIDFIT  0x01
#define TT_GASP_DOGRAY   0x02


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Gasp                                                            */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure modeling the TrueType `gasp' table used to specify     */
  /*    grid-fitting and anti-aliasing behaviour.                          */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    version    :: The version number.                                  */
  /*                                                                       */
  /*    numRanges  :: The number of gasp ranges in table.                  */
  /*                                                                       */
  /*    gaspRanges :: An array of gasp ranges.                             */
  /*                                                                       */
  typedef struct  TT_Gasp_
  {
    FT_UShort      version;
    FT_UShort      numRanges;
    TT_GaspRange*  gaspRanges;

  } TT_Gasp;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_HdmxRec                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A small structure used to model the pre-computed widths of a given */
  /*    size.  They are found in the `hdmx' table.                         */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    ppem      :: The pixels per EM value at which these metrics apply. */
  /*                                                                       */
  /*    max_width :: The maximum advance width for this metric.            */
  /*                                                                       */
  /*    widths    :: An array of widths.  Note: These are 8-bit bytes.     */
  /*                                                                       */
  typedef struct  TT_HdmxRec_
  {
    FT_Byte   ppem;
    FT_Byte   max_width;
    FT_Byte*  widths;

  } TT_HdmxRec;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Hdmx                                                            */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used to model the `hdmx' table, which contains         */
  /*    pre-computed widths for a set of given sizes/dimensions.           */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    version     :: The version number.                                 */
  /*                                                                       */
  /*    num_records :: The number of hdmx records.                         */
  /*                                                                       */
  /*    records     :: An array of hdmx records.                           */
  /*                                                                       */
  typedef struct  TT_Hdmx_
  {
    FT_UShort    version;
    FT_Short     num_records;
    TT_HdmxRec*  records;

  } TT_Hdmx;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Kern_0_Pair                                                     */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used to model a kerning pair for the kerning table     */
  /*    format 0.  The engine now loads this table if it finds one in the  */
  /*    font file.                                                         */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    left  :: The index of the left glyph in pair.                      */
  /*                                                                       */
  /*    right :: The index of the right glyph in pair.                     */
  /*                                                                       */
  /*    value :: The kerning distance.  A positive value spaces the        */
  /*             glyphs, a negative one makes them closer.                 */
  /*                                                                       */
  typedef struct  TT_Kern_0_Pair_
  {
    FT_UShort  left;   /* index of left  glyph in pair */
    FT_UShort  right;  /* index of right glyph in pair */
    FT_FWord   value;  /* kerning value                */

  } TT_Kern_0_Pair;


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***                    EMBEDDED BITMAPS SUPPORT                       ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Metrics                                                    */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used to hold the big metrics of a given glyph bitmap   */
  /*    in a TrueType or OpenType font.  These are usually found in the    */
  /*    `EBDT' (Microsoft) or `bloc' (Apple) table.                        */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    height       :: The glyph height in pixels.                        */
  /*                                                                       */
  /*    width        :: The glyph width in pixels.                         */
  /*                                                                       */
  /*    horiBearingX :: The horizontal left bearing.                       */
  /*                                                                       */
  /*    horiBearingY :: The horizontal top bearing.                        */
  /*                                                                       */
  /*    horiAdvance  :: The horizontal advance.                            */
  /*                                                                       */
  /*    vertBearingX :: The vertical left bearing.                         */
  /*                                                                       */
  /*    vertBearingY :: The vertical top bearing.                          */
  /*                                                                       */
  /*    vertAdvance  :: The vertical advance.                              */
  /*                                                                       */
  typedef struct  TT_SBit_Metrics_
  {
    FT_Byte  height;
    FT_Byte  width;

    FT_Char  horiBearingX;
    FT_Char  horiBearingY;
    FT_Byte  horiAdvance;

    FT_Char  vertBearingX;
    FT_Char  vertBearingY;
    FT_Byte  vertAdvance;

  } TT_SBit_Metrics;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Small_Metrics                                              */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used to hold the small metrics of a given glyph bitmap */
  /*    in a TrueType or OpenType font.  These are usually found in the    */
  /*    `EBDT' (Microsoft) or the `bdat' (Apple) table.                    */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    height   :: The glyph height in pixels.                            */
  /*                                                                       */
  /*    width    :: The glyph width in pixels.                             */
  /*                                                                       */
  /*    bearingX :: The left-side bearing.                                 */
  /*                                                                       */
  /*    bearingY :: The top-side bearing.                                  */
  /*                                                                       */
  /*    advance  :: The advance width or height.                           */
  /*                                                                       */
  typedef struct  TT_SBit_Small_Metrics_
  {
    FT_Byte  height;
    FT_Byte  width;

    FT_Char  bearingX;
    FT_Char  bearingY;
    FT_Byte  advance;

  } TT_SBit_Small_Metrics;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Line_Metrics                                               */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used to describe the text line metrics of a given      */
  /*    bitmap strike, for either a horizontal or vertical layout.         */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    ascender                :: The ascender in pixels.                 */
  /*                                                                       */
  /*    descender               :: The descender in pixels.                */
  /*                                                                       */
  /*    max_width               :: The maximum glyph width in pixels.      */
  /*                                                                       */
  /*    caret_slope_enumerator  :: Rise of the caret slope, typically set  */
  /*                               to 1 for non-italic fonts.              */
  /*                                                                       */
  /*    caret_slope_denominator :: Rise of the caret slope, typically set  */
  /*                               to 0 for non-italic fonts.              */
  /*                                                                       */
  /*    caret_offset            :: Offset in pixels to move the caret for  */
  /*                               proper positioning.                     */
  /*                                                                       */
  /*    min_origin_SB           :: Minimum of horiBearingX (resp.          */
  /*                               vertBearingY).                          */
  /*    min_advance_SB          :: Minimum of                              */
  /*                                                                       */
  /*                                 horizontal advance -                  */
  /*                                   ( horiBearingX + width )            */
  /*                                                                       */
  /*                               resp.                                   */
  /*                                                                       */
  /*                                 vertical advance -                    */
  /*                                   ( vertBearingY + height )           */
  /*                                                                       */
  /*    max_before_BL           :: Maximum of horiBearingY (resp.          */
  /*                               vertBearingY).                          */
  /*                                                                       */
  /*    min_after_BL            :: Minimum of                              */
  /*                                                                       */
  /*                                 horiBearingY - height                 */
  /*                                                                       */
  /*                               resp.                                   */
  /*                                                                       */
  /*                                 vertBearingX - width                  */
  /*                                                                       */
  /*    pads                    :: Unused (to make the size of the record  */
  /*                               a multiple of 32 bits.                  */
  /*                                                                       */
  typedef struct  TT_SBit_Line_Metrics_
  {
    FT_Char  ascender;
    FT_Char  descender;
    FT_Byte  max_width;
    FT_Char  caret_slope_numerator;
    FT_Char  caret_slope_denominator;
    FT_Char  caret_offset;
    FT_Char  min_origin_SB;
    FT_Char  min_advance_SB;
    FT_Char  max_before_BL;
    FT_Char  min_after_BL;
    FT_Char  pads[2];

  } TT_SBit_Line_Metrics;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Range                                                      */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A TrueType/OpenType subIndexTable as defined in the `EBLC'         */
  /*    (Microsoft) or `bloc' (Apple) tables.                              */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    first_glyph   :: The first glyph index in the range.               */
  /*                                                                       */
  /*    last_glyph    :: The last glyph index in the range.                */
  /*                                                                       */
  /*    index_format  :: The format of index table.  Valid values are 1    */
  /*                     to 5.                                             */
  /*                                                                       */
  /*    image_format  :: The format of `EBDT' image data.                  */
  /*                                                                       */
  /*    image_offset  :: The offset to image data in `EBDT'.               */
  /*                                                                       */
  /*    image_size    :: For index formats 2 and 5.  This is the size in   */
  /*                     bytes of each glyph bitmap.                       */
  /*                                                                       */
  /*    big_metrics   :: For index formats 2 and 5.  This is the big       */
  /*                     metrics for each glyph bitmap.                    */
  /*                                                                       */
  /*    num_glyphs    :: For index formats 4 and 5.  This is the number of */
  /*                     glyphs in the code array.                         */
  /*                                                                       */
  /*    glyph_offsets :: For index formats 1 and 3.                        */
  /*                                                                       */
  /*    glyph_codes   :: For index formats 4 and 5.                        */
  /*                                                                       */
  /*    table_offset  :: The offset of the index table in the `EBLC'       */
  /*                     table.  Only used during strike loading.          */
  /*                                                                       */
  typedef struct  TT_SBit_Range
  {
    FT_UShort        first_glyph;
    FT_UShort        last_glyph;

    FT_UShort        index_format;
    FT_UShort        image_format;
    FT_ULong         image_offset;

    FT_ULong         image_size;
    TT_SBit_Metrics  metrics;
    FT_ULong         num_glyphs;

    FT_ULong*        glyph_offsets;
    FT_UShort*       glyph_codes;

    FT_ULong         table_offset;

  } TT_SBit_Range;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Strike                                                     */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used describe a given bitmap strike in the `EBLC'      */
  /*    (Microsoft) or `bloc' (Apple) tables.                              */
  /*                                                                       */
  /* <Fields>                                                              */
  /*   num_index_ranges :: The number of index ranges.                     */
  /*                                                                       */
  /*   index_ranges     :: An array of glyph index ranges.                 */
  /*                                                                       */
  /*   color_ref        :: Unused.  `color_ref' is put in for future       */
  /*                       enhancements, but these fields are already      */
  /*                       in use by other platforms (e.g. Newton).        */
  /*                       For details, please see                         */
  /*                                                                       */
  /*                         http://fonts.apple.com/                       */
  /*                                TTRefMan/RM06/Chap6bloc.html           */
  /*                                                                       */
  /*   hori             :: The line metrics for horizontal layouts.        */
  /*                                                                       */
  /*   vert             :: The line metrics for vertical layouts.          */
  /*                                                                       */
  /*   start_glyph      :: The lowest glyph index for this strike.         */
  /*                                                                       */
  /*   end_glyph        :: The highest glyph index for this strike.        */
  /*                                                                       */
  /*   x_ppem           :: The number of horizontal pixels per EM.         */
  /*                                                                       */
  /*   y_ppem           :: The number of vertical pixels per EM.           */
  /*                                                                       */
  /*   bit_depth        :: The bit depth.  Valid values are 1, 2, 4,       */
  /*                       and 8.                                          */
  /*                                                                       */
  /*   flags            :: Is this a vertical or horizontal strike?  For   */
  /*                       details, please see                             */
  /*                                                                       */
  /*                         http://fonts.apple.com/                       */
  /*                                TTRefMan/RM06/Chap6bloc.html           */
  /*                                                                       */
  typedef struct  TT_SBit_Strike_
  {
    FT_Int                num_ranges;
    TT_SBit_Range*        sbit_ranges;
    FT_ULong              ranges_offset;

    FT_ULong              color_ref;

    TT_SBit_Line_Metrics  hori;
    TT_SBit_Line_Metrics  vert;

    FT_UShort             start_glyph;
    FT_UShort             end_glyph;

    FT_Byte               x_ppem;
    FT_Byte               y_ppem;

    FT_Byte               bit_depth;
    FT_Char               flags;

  } TT_SBit_Strike;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Component                                                  */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A simple structure to describe a compound sbit element.            */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    glyph_code :: The element's glyph index.                           */
  /*                                                                       */
  /*    x_offset   :: The element's left bearing.                          */
  /*                                                                       */
  /*    y_offset   :: The element's top bearing.                           */
  /*                                                                       */
  typedef struct  TT_SBit_Component_
  {
    FT_UShort  glyph_code;
    FT_Char    x_offset;
    FT_Char    y_offset;

  } TT_SBit_Component;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_SBit_Scale                                                      */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A structure used describe a given bitmap scaling table, as defined */
  /*    in the `EBSC' table.                                               */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    hori              :: The horizontal line metrics.                  */
  /*                                                                       */
  /*    vert              :: The vertical line metrics.                    */
  /*                                                                       */
  /*    x_ppem            :: The number of horizontal pixels per EM.       */
  /*                                                                       */
  /*    y_ppem            :: The number of vertical pixels per EM.         */
  /*                                                                       */
  /*    x_ppem_substitute :: Substitution x_ppem value.                    */
  /*                                                                       */
  /*    y_ppem_substitute :: Substitution y_ppem value.                    */
  /*                                                                       */
  typedef struct  TT_SBit_Scale_
  {
    TT_SBit_Line_Metrics  hori;
    TT_SBit_Line_Metrics  vert;

    FT_Byte               x_ppem;
    FT_Byte               y_ppem;

    FT_Byte               x_ppem_substitute;
    FT_Byte               y_ppem_substitute;

  } TT_SBit_Scale;


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***                  POSTSCRIPT GLYPH NAMES SUPPORT                   ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Post_20                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Postscript names sub-table, format 2.0.  Stores the PS name of     */
  /*    each glyph in the font face.                                       */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    num_glyphs    :: The number of named glyphs in the table.          */
  /*                                                                       */
  /*    num_names     :: The number of PS names stored in the table.       */
  /*                                                                       */
  /*    glyph_indices :: The indices of the glyphs in the names arrays.    */
  /*                                                                       */
  /*    glyph_names   :: The PS names not in Mac Encoding.                 */
  /*                                                                       */
  typedef struct  TT_Post_20_
  {
    FT_UShort   num_glyphs;
    FT_UShort   num_names;
    FT_UShort*  glyph_indices;
    FT_Char**   glyph_names;

  } TT_Post_20;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Post_25                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Postscript names sub-table, format 2.5.  Stores the PS name of     */
  /*    each glyph in the font face.                                       */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    num_glyphs :: The number of glyphs in the table.                   */
  /*                                                                       */
  /*    offsets    :: An array of signed offsets in a normal Mac           */
  /*                  Postscript name encoding.                            */
  /*                                                                       */
  typedef struct  TT_Post_25_
  {
    FT_UShort  num_glyphs;
    FT_Char*   offsets;

  } TT_Post_25;


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Post_Names                                                      */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Postscript names table, either format 2.0 or 2.5.                  */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    loaded    :: A flag to indicate whether the PS names are loaded.   */
  /*                                                                       */
  /*    format_20 :: The sub-table used for format 2.0.                    */
  /*                                                                       */
  /*    format_25 :: The sub-table used for format 2.5.                    */
  /*                                                                       */
  typedef struct  TT_Post_Names_
  {
    FT_Bool       loaded;

    union
    {
      TT_Post_20  format_20;
      TT_Post_25  format_25;

    } names;

  } TT_Post_Names;


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***                  TRUETYPE CHARMAPS SUPPORT                        ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /* format 0 */

  typedef struct  TT_CMap0_
  {
    FT_ULong  language;       /* for Mac fonts (originally ushort) */

    FT_Byte*  glyphIdArray;

  } TT_CMap0;


  /* format 2 */

  typedef struct  TT_CMap2SubHeader_
  {
    FT_UShort  firstCode;      /* first valid low byte         */
    FT_UShort  entryCount;     /* number of valid low bytes    */
    FT_Short   idDelta;        /* delta value to glyphIndex    */
    FT_UShort  idRangeOffset;  /* offset from here to 1st code */

  } TT_CMap2SubHeader;


  typedef struct  TT_CMap2_
  {
    FT_ULong            language;     /* for Mac fonts (originally ushort) */

    FT_UShort*          subHeaderKeys;
    /* high byte mapping table            */
    /* value = subHeader index * 8        */

    TT_CMap2SubHeader*  subHeaders;
    FT_UShort*          glyphIdArray;
    FT_UShort           numGlyphId;   /* control value */

  } TT_CMap2;


  /* format 4 */

  typedef struct  TT_CMap4Segment_
  {
    FT_UShort  endCount;
    FT_UShort  startCount;
    FT_Short   idDelta;
    FT_UShort  idRangeOffset;

  } TT_CMap4Segment;


  typedef struct  TT_CMap4_
  {
    FT_ULong          language;       /* for Mac fonts (originally ushort) */

    FT_UShort         segCountX2;     /* number of segments * 2            */
    FT_UShort         searchRange;    /* these parameters can be used      */
    FT_UShort         entrySelector;  /* for a binary search               */
    FT_UShort         rangeShift;

    TT_CMap4Segment*  segments;
    FT_UShort*        glyphIdArray;
    FT_UShort         numGlyphId;    /* control value */

    TT_CMap4Segment*  last_segment;  /* last used segment; this is a small  */
                                     /* cache to potentially increase speed */
  } TT_CMap4;


  /* format 6 */

  typedef struct  TT_CMap6_
  {
    FT_ULong    language;       /* for Mac fonts (originally ushort)     */

    FT_UShort   firstCode;      /* first character code of subrange      */
    FT_UShort   entryCount;     /* number of character codes in subrange */

    FT_UShort*  glyphIdArray;

  } TT_CMap6;


  /* auxiliary table for format 8 and 12 */

  typedef struct  TT_CMapGroup_
  {
    FT_ULong  startCharCode;
    FT_ULong  endCharCode;
    FT_ULong  startGlyphID;

  } TT_CMapGroup;


  /* FreeType handles format 8 and 12 identically.  It is not necessary to
     cover mixed 16bit and 32bit codes since FreeType always uses FT_ULong
     for input character codes -- converting Unicode surrogates to 32bit
     character codes must be done by the application.                      */

  typedef struct  TT_CMap8_12_
  {
    FT_ULong       language;        /* for Mac fonts */

    FT_ULong       nGroups;
    TT_CMapGroup*  groups;

    TT_CMapGroup*  last_group;      /* last used group; this is a small    */
                                    /* cache to potentially increase speed */
  } TT_CMap8_12;


  /* format 10 */

  typedef struct  TT_CMap10_
  {
    FT_ULong    language;           /* for Mac fonts */

    FT_ULong    startCharCode;      /* first character covered */
    FT_ULong    numChars;           /* number of characters covered */

    FT_UShort*  glyphs;

  } TT_CMap10;


  typedef struct TT_CMapTable_  TT_CMapTable;


  typedef FT_UInt
  (*TT_CharMap_Func)( TT_CMapTable*  charmap,
                      FT_ULong       char_code );


  /* charmap table */
  struct  TT_CMapTable_
  {
    FT_UShort  platformID;
    FT_UShort  platformEncodingID;
    FT_UShort  format;
    FT_ULong   length;          /* must be ulong for formats 8, 10, and 12 */

    FT_Bool    loaded;
    FT_ULong   offset;

    union
    {
      TT_CMap0     cmap0;
      TT_CMap2     cmap2;
      TT_CMap4     cmap4;
      TT_CMap6     cmap6;
      TT_CMap8_12  cmap8_12;
      TT_CMap10    cmap10;
    } c;

    TT_CharMap_Func  get_index;
  };


  /*************************************************************************/
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_CharMapRec                                                      */
  /*                                                                       */
  /* <Description>                                                         */
  /*    The TrueType character map object type.                            */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    root :: The parent character map structure.                        */
  /*                                                                       */
  /*    cmap :: The used character map.                                    */
  /*                                                                       */
  typedef struct  TT_CharMapRec_
  {
    FT_CharMapRec  root;
    TT_CMapTable   cmap;

  } TT_CharMapRec;


  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/
  /***                                                                   ***/
  /***                                                                   ***/
  /***                  ORIGINAL TT_FACE CLASS DEFINITION                ***/
  /***                                                                   ***/
  /***                                                                   ***/
  /*************************************************************************/
  /*************************************************************************/
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* This structure/class is defined here because it is common to the      */
  /* following formats: TTF, OpenType-TT, and OpenType-CFF.                */
  /*                                                                       */
  /* Note, however, that the classes TT_Size, TT_GlyphSlot, and TT_CharMap */
  /* are not shared between font drivers, and are thus defined normally in */
  /* `ttobjs.h'.                                                           */
  /*                                                                       */
  /*************************************************************************/


  /*************************************************************************/
  /*                                                                       */
  /* <Type>                                                                */
  /*    TT_Face                                                            */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A handle to a TrueType face/font object.  A TT_Face encapsulates   */
  /*    the resolution and scaling independent parts of a TrueType font    */
  /*    resource.                                                          */
  /*                                                                       */
  /* <Note>                                                                */
  /*    The TT_Face structure is also used as a `parent class' for the     */
  /*    OpenType-CFF class (T2_Face).                                      */
  /*                                                                       */
  typedef struct TT_FaceRec_*  TT_Face;


  /*************************************************************************/
  /*                                                                       */
  /* <Type>                                                                */
  /*    TT_CharMap                                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    A handle to a TrueType character mapping object.                   */
  /*                                                                       */
  typedef struct TT_CharMapRec_*  TT_CharMap;


  /* a function type used for the truetype bytecode interpreter hooks */
  typedef FT_Error
  (*TT_Interpreter)( void*  exec_context );

  /* forward declaration */
  typedef struct TT_Loader_  TT_Loader;


  /*************************************************************************/
  /*                                                                       */
  /* <FuncType>                                                            */
  /*    TT_Goto_Table_Func                                                 */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Seeks a stream to the start of a given TrueType table.             */
  /*                                                                       */
  /* <Input>                                                               */
  /*    face   :: A handle to the target face object.                      */
  /*                                                                       */
  /*    tag    :: A 4-byte tag used to name the table.                     */
  /*                                                                       */
  /*    stream :: The input stream.                                        */
  /*                                                                       */
  /* <Output>                                                              */
  /*    length :: The length of the table in bytes.  Set to 0 if not       */
  /*              needed.                                                  */
  /*                                                                       */
  /* <Return>                                                              */
  /*    FreeType error code.  0 means success.                             */
  /*                                                                       */
  /* <Note>                                                                */
  /*    The stream cursor must be at the font file's origin.               */
  /*                                                                       */
  typedef FT_Error
  (*TT_Goto_Table_Func)( TT_Face    face,
                         FT_ULong   tag,
                         FT_Stream  stream,
                         FT_ULong*  length );


  /*************************************************************************/
  /*                                                                       */
  /* <FuncType>                                                            */
  /*    TT_Access_Glyph_Frame_Func                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Seeks a stream to the start of a given glyph element, and opens a  */
  /*    frame for it.                                                      */
  /*                                                                       */
  /* <Input>                                                               */
  /*    loader      :: The current TrueType glyph loader object.           */
  /*                                                                       */
  /*    glyph index :: The index of the glyph to access.                   */
  /*                                                                       */
  /*    offset      :: The offset of the glyph according to the            */
  /*                   `locations' table.                                  */
  /*                                                                       */
  /*    byte_count  :: The size of the frame in bytes.                     */
  /*                                                                       */
  /* <Return>                                                              */
  /*    FreeType error code.  0 means success.                             */
  /*                                                                       */
  /* <Note>                                                                */
  /*    This function is normally equivalent to FILE_Seek(offset)          */
  /*    followed by ACCESS_Frame(byte_count) with the loader's stream, but */
  /*    alternative formats (e.g. compressed ones) might use something     */
  /*    different.                                                         */
  /*                                                                       */
  typedef FT_Error
  (*TT_Access_Glyph_Frame_Func)( TT_Loader*  loader,
                                 FT_UInt     glyph_index,
                                 FT_ULong    offset,
                                 FT_UInt     byte_count );


  /*************************************************************************/
  /*                                                                       */
  /* <FuncType>                                                            */
  /*    TT_Load_Glyph_Element_Func                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Reads one glyph element (its header, a simple glyph, or a          */
  /*    composite) from the loader's current stream frame.                 */
  /*                                                                       */
  /* <Input>                                                               */
  /*    loader :: The current TrueType glyph loader object.                */
  /*                                                                       */
  /* <Return>                                                              */
  /*    FreeType error code.  0 means success.                             */
  /*                                                                       */
  typedef FT_Error
  (*TT_Load_Glyph_Element_Func)( TT_Loader*  loader );


  /*************************************************************************/
  /*                                                                       */
  /* <FuncType>                                                            */
  /*    TT_Forget_Glyph_Frame_Func                                         */
  /*                                                                       */
  /* <Description>                                                         */
  /*    Closes the current loader stream frame for the glyph.              */
  /*                                                                       */
  /* <Input>                                                               */
  /*    loader :: The current TrueType glyph loader object.                */
  /*                                                                       */
  typedef void
  (*TT_Forget_Glyph_Frame_Func)( TT_Loader*  loader );



  /*************************************************************************/
  /*                                                                       */
  /*                         TrueType Face Type                            */
  /*                                                                       */
  /* <Struct>                                                              */
  /*    TT_Face                                                            */
  /*                                                                       */
  /* <Description>                                                         */
  /*    The TrueType face class.  These objects model the resolution and   */
  /*    point-size independent data found in a TrueType font file.         */
  /*                                                                       */
  /* <Fields>                                                              */
  /*    root                 :: The base FT_Face structure, managed by the */
  /*                            base layer.                                */
  /*                                                                       */
  /*    ttc_header           :: The TrueType collection header, used when  */
  /*                            the file is a `ttc' rather than a `ttf'.   */
  /*                            For ordinary font files, the field         */
  /*                            `ttc_header.count' is set to 0.            */
  /*                                                                       */
  /*    format_tag           :: The font format tag.                       */
  /*                                                                       */
  /*    num_tables           :: The number of TrueType tables in this font */
  /*                            file.                                      */
  /*                                                                       */
  /*    dir_tables           :: The directory of TrueType tables for this  */
  /*                            font file.                                 */
  /*                                                                       */
  /*    header               :: The font's font header (`head' table).     */
  /*                            Read on font opening.                      */
  /*                                                                       */
  /*    horizontal           :: The font's horizontal header (`hhea'       */
  /*                            table).  This field also contains the      */
  /*                            associated horizontal metrics table        */
  /*                            (`hmtx').                                  */
  /*                                                                       */
  /*    max_profile          :: The font's maximum profile table.  Read on */
  /*                            font opening.  Note that some maximum      */
  /*                            values cannot be taken directly from this  */
  /*                            table.  We thus define additional fields   */
  /*                            below to hold the computed maxima.         */
  /*                                                                       */
  /*    max_components       :: The maximum number of glyph components     */
  /*                            required to load any composite glyph from  */
  /*                            this font.  Used to size the load stack.   */
  /*                                                                       */
  /*    vertical_info        :: A boolean which is set when the font file  */
  /*                            contains vertical metrics.  If not, the    */
  /*                            value of the `vertical' field is           */
  /*                            undefined.                                 */
  /*                                                                       */
  /*    vertical             :: The font's vertical header (`vhea' table). */
  /*                            This field also contains the associated    */
  /*                            vertical metrics table (`vmtx'), if found. */
  /*                            IMPORTANT: The contents of this field is   */
  /*                            undefined if the `verticalInfo' field is   */
  /*                            unset.                                     */
  /*                                                                       */
  /*    num_names            :: The number of name records within this     */
  /*                            TrueType font.                             */
  /*                                                                       */
  /*    name_table           :: The table of name records (`name').        */
  /*                                                                       */
  /*    os2                  :: The font's OS/2 table (`OS/2').            */
  /*                                                                       */
  /*    postscript           :: The font's PostScript table (`post'        */
  /*                            table).  The PostScript glyph names are    */
  /*                            not loaded by the driver on face opening.  */
  /*                            See the `ttpost' module for more details.  */
  /*                                                                       */
  /*    num_charmaps         :: The number of character mappings in the    */
  /*                            font.                                      */
  /*                                                                       */
  /*    charmaps             :: The array of charmap objects for this font */
  /*                            file.  Note that this field is a typeless  */
  /*                            pointer.  The Reason is that the format of */
  /*                            charmaps varies with the underlying font   */
  /*                            format and cannot be determined here.      */
  /*                                                                       */
  /*    goto_table           :: A function called by each TrueType table   */
  /*                            loader to position a stream's cursor to    */
  /*                            the start of a given table according to    */
  /*                            its tag.  It defaults to TT_Goto_Face but  */
  /*                            can be different for strange formats (e.g. */
  /*                            Type 42).                                  */
  /*                                                                       */
  /*    access_glyph_frame   :: XXX                                        */
  /*                                                                       */
  /*    read_glyph_header    :: XXX                                        */
  /*                                                                       */
  /*    read_simple_glyph    :: XXX                                        */
  /*                                                                       */
  /*    read_composite_glyph :: XXX                                        */
  /*                                                                       */
  /*    forget_glyph_frame   :: XXX                                        */
  /*                                                                       */
  /*    sfnt                 :: A pointer to the SFNT `driver' interface.  */
  /*                                                                       */
  /*    psnames              :: A pointer to the `PSNames' module          */
  /*                            interface.                                 */
  /*                                                                       */
  /*    hdmx                 :: The face's horizontal device metrics       */
  /*                            (`hdmx' table).  This table is optional in */
  /*                            TrueType/OpenType fonts.                   */
  /*                                                                       */
  /*    gasp                 :: The grid-fitting and scaling properties    */
  /*                            table (`gasp').  This table is optional in */
  /*                            TrueType/OpenType fonts.                   */
  /*                                                                       */
  /*    pclt                 :: XXX                                        */
  /*                                                                       */
  /*    num_sbit_strikes     :: The number of sbit strikes, i.e., bitmap   */
  /*                            sizes, embedded in this font.              */
  /*                                                                       */
  /*    sbit_strikes         :: An array of sbit strikes embedded in this  */
  /*                            font.  This table is optional in a         */
  /*                            TrueType/OpenType font.                    */
  /*                                                                       */
  /*    num_sbit_scales      :: The number of sbit scales for this font.   */
  /*                                                                       */
  /*    sbit_scales          :: Array of sbit scales embedded in this      */
  /*                            font.  This table is optional in a         */
  /*                            TrueType/OpenType font.                    */
  /*                                                                       */
  /*    postscript_names     :: A table used to store the Postscript names */
  /*                            of  the glyphs for this font.  See the     */
  /*                            file  `ttconfig.h' for comments on the     */
  /*                            TT_CONFIG_OPTION_POSTSCRIPT_NAMES option.  */
  /*                                                                       */
  /*    num_locations        :: The number of glyph locations in this      */
  /*                            TrueType file.  This should be             */
  /*                            identical to the number of glyphs.         */
  /*                            Ignored for Type 2 fonts.                  */
  /*                                                                       */
  /*    glyph_locations      :: An array of longs.  These are offsets to   */
  /*                            glyph data within the `glyf' table.        */
  /*                            Ignored for Type 2 font faces.             */
  /*                                                                       */
  /*    font_program_size    :: Size in bytecodes of the face's font       */
  /*                            program.  0 if none defined.  Ignored for  */
  /*                            Type 2 fonts.                              */
  /*                                                                       */
  /*    font_program         :: The face's font program (bytecode stream)  */
  /*                            executed at load time, also used during    */
  /*                            glyph rendering.  Comes from the `fpgm'    */
  /*                            table.  Ignored for Type 2 font fonts.     */
  /*                                                                       */
  /*    cvt_program_size     :: The size in bytecodes of the face's cvt    */
  /*                            program.  Ignored for Type 2 fonts.        */
  /*                                                                       */
  /*    cvt_program          :: The face's cvt program (bytecode stream)   */
  /*                            executed each time an instance/size is     */
  /*                            changed/reset.  Comes from the `prep'      */
  /*                            table.  Ignored for Type 2 fonts.          */
  /*                                                                       */
  /*    cvt_size             :: Size of the control value table (in        */
  /*                            entries).   Ignored for Type 2 fonts.      */
  /*                                                                       */
  /*    cvt                  :: The face's original control value table.   */
  /*                            Coordinates are expressed in unscaled font */
  /*                            units.  Comes from the `cvt ' table.       */
  /*                            Ignored for Type 2 fonts.                  */
  /*                                                                       */
  /*    num_kern_pairs       :: The number of kerning pairs present in the */
  /*                            font file.  The engine only loads the      */
  /*                            first horizontal format 0 kern table it    */
  /*                            finds in the font file.  You should use    */
  /*                            the `ttxkern' structures if you want to    */
  /*                            access other kerning tables.  Ignored      */
  /*                            for Type 2 fonts.                          */
  /*                                                                       */
  /*    kern_table_index     :: The index of the kerning table in the font */
  /*                            kerning directory.  Only used by the       */
  /*                            ttxkern extension to avoid data            */
  /*                            duplication.  Ignored for Type 2 fonts.    */
  /*                                                                       */
  /*    interpreter          :: A pointer to the TrueType bytecode         */
  /*                            interpreters field is also used to hook    */
  /*                            the debugger in `ttdebug'.                 */
  /*                                                                       */
  /*    extra                :: XXX                                        */
  /*                                                                       */
  typedef struct  TT_FaceRec_
  {
    FT_FaceRec         root;

    TTC_Header         ttc_header;

    FT_ULong           format_tag;
    FT_UShort          num_tables;
    TT_Table*          dir_tables;

    TT_Header          header;       /* TrueType header table          */
    TT_HoriHeader      horizontal;   /* TrueType horizontal header     */

    TT_MaxProfile      max_profile;
    FT_ULong           max_components;

    FT_Bool            vertical_info;
    TT_VertHeader      vertical;     /* TT Vertical header, if present */

    FT_UShort          num_names;    /* number of name records  */
    TT_NameTable       name_table;   /* name table              */

    TT_OS2             os2;          /* TrueType OS/2 table            */
    TT_Postscript      postscript;   /* TrueType Postscript table      */

    FT_Int             num_charmaps;
    TT_CharMap         charmaps;     /* array of TT_CharMapRec */

    TT_Goto_Table_Func          goto_table;

    TT_Access_Glyph_Frame_Func  access_glyph_frame;
    TT_Load_Glyph_Element_Func  read_glyph_header;
    TT_Load_Glyph_Element_Func  read_simple_glyph;
    TT_Load_Glyph_Element_Func  read_composite_glyph;
    TT_Forget_Glyph_Frame_Func  forget_glyph_frame;

    /* a typeless pointer to the SFNT_Interface table used to load     */
    /* the basic TrueType tables in the face object                    */
    void*              sfnt;

    /* a typeless pointer to the PSNames_Interface table used to       */
    /* handle glyph names <-> unicode & Mac values                     */
    void*              psnames;

    /***********************************************************************/
    /*                                                                     */
    /* Optional TrueType/OpenType tables                                   */
    /*                                                                     */
    /***********************************************************************/

    /* horizontal device metrics */
    TT_Hdmx            hdmx;

    /* grid-fitting and scaling table */
    TT_Gasp            gasp;                 /* the `gasp' table */

    /* PCL 5 table */
    TT_PCLT            pclt;

    /* embedded bitmaps support */
    FT_Int             num_sbit_strikes;
    TT_SBit_Strike*    sbit_strikes;

    FT_Int             num_sbit_scales;
    TT_SBit_Scale*     sbit_scales;

    /* postscript names table */
    TT_Post_Names      postscript_names;


    /***********************************************************************/
    /*                                                                     */
    /* TrueType-specific fields (ignored by the OTF-Type2 driver)          */
    /*                                                                     */
    /***********************************************************************/

    /* the glyph locations */
    FT_UShort          num_locations;
    FT_Long*           glyph_locations;

    /* the font program, if any */
    FT_ULong           font_program_size;
    FT_Byte*           font_program;

    /* the cvt program, if any */
    FT_ULong           cvt_program_size;
    FT_Byte*           cvt_program;

    /* the original, unscaled, control value table */
    FT_ULong           cvt_size;
    FT_Short*          cvt;

    /* the format 0 kerning table, if any */
    FT_Int             num_kern_pairs;
    FT_Int             kern_table_index;
    TT_Kern_0_Pair*    kern_pairs;

    /* A pointer to the bytecode interpreter to use.  This is also */
    /* used to hook the debugger for the `ttdebug' utility.        */
    TT_Interpreter     interpreter;


    /***********************************************************************/
    /*                                                                     */
    /* Other tables or fields. This is used by derivative formats like     */
    /* OpenType.                                                           */
    /*                                                                     */
    /***********************************************************************/

    FT_Generic      extra;

  } TT_FaceRec;


  /*************************************************************************/
  /*                                                                       */
  /*  <Struct>                                                             */
  /*     TT_GlyphZone                                                      */
  /*                                                                       */
  /*  <Description>                                                        */
  /*     A glyph zone is used to load, scale and hint glyph outline        */
  /*     coordinates.                                                      */
  /*                                                                       */
  /*  <Fields>                                                             */
  /*     memory       :: A handle to the memory manager.                   */
  /*                                                                       */
  /*     max_points   :: The maximal size in points of the zone.           */
  /*                                                                       */
  /*     max_contours :: Max size in links contours of thez one.           */
  /*                                                                       */
  /*     n_points     :: The current number of points in the zone.         */
  /*                                                                       */
  /*     n_contours   :: The current number of contours in the zone.       */
  /*                                                                       */
  /*     org          :: The original glyph coordinates (font              */
  /*                     units/scaled).                                    */
  /*                                                                       */
  /*     cur          :: The current glyph coordinates (scaled/hinted).    */
  /*                                                                       */
  /*     tags         :: The point control tags.                           */
  /*                                                                       */
  /*     contours     :: The contours end points.                          */
  /*                                                                       */
  typedef struct  TT_GlyphZone_
  {
    FT_Memory   memory;
    FT_UShort   max_points;
    FT_UShort   max_contours;
    FT_UShort   n_points;   /* number of points in zone    */
    FT_Short    n_contours; /* number of contours          */

    FT_Vector*  org;        /* original point coordinates  */
    FT_Vector*  cur;        /* current point coordinates   */

    FT_Byte*    tags;       /* current touch flags         */
    FT_UShort*  contours;   /* contour end points          */

  } TT_GlyphZone;


  /* handle to execution context */
  typedef struct TT_ExecContextRec_*  TT_ExecContext;

  /* glyph loader structure */
  struct  TT_Loader_
  {
    FT_Face          face;
    FT_Size          size;
    FT_GlyphSlot     glyph;
    FT_GlyphLoader*  gloader;

    FT_ULong         load_flags;
    FT_UInt          glyph_index;

    FT_Stream        stream;
    FT_Int           byte_len;

    FT_Short         n_contours;
    FT_BBox          bbox;
    FT_Int           left_bearing;
    FT_Int           advance;
    FT_Int           linear;
    FT_Bool          linear_def;
    FT_Bool          preserve_pps;
    FT_Vector        pp1;
    FT_Vector        pp2;

    FT_ULong         glyf_offset;

    /* the zone where we load our glyphs */
    TT_GlyphZone     base;
    TT_GlyphZone     zone;

    TT_ExecContext   exec;
    FT_Byte*         instructions;
    FT_ULong         ins_pos;

    /* for possible extensibility in other formats */
    void*            other;
  };


FT_END_HEADER

#endif /* __TTTYPES_H__ */


/* END */
@


1.1
log
@Initial revision
@
text
@@


1.1.9.1
log
@OpenBSD just has imported exactly this tree into their vendor branch,
called the same tag, in XF4/xc
This is, apparently, the last XFree86 snapshot before the licence change
(ie, addition of the advertising clause)

Since the developers don't see any problems with that, and we would like
to integrate improvements done by the remaining one or two (or so) XFree86
developers (j/k), this prepares enabling us to update X-Window in the future.
@
text
@d8 1
a8 1
/*  Copyright 1996-2001, 2002 by                                           */
d48 1
a48 1
  /*    TTC_HeaderRec                                                      */
d66 1
a66 1
  typedef struct  TTC_HeaderRec_
d73 1
a73 1
  } TTC_HeaderRec;
d79 1
a79 1
  /*    SFNT_HeaderRec                                                     */
d89 1
a89 1
  /*    search_range   :: Must be `16 * (max power of 2 <= num_tables)'.   */
d91 1
a91 1
  /*    entry_selector :: Must be log2 of `search_range / 16'.             */
d93 1
a93 1
  /*    range_shift    :: Must be `num_tables * 16 - search_range'.        */
d95 1
a95 1
  typedef struct  SFNT_HeaderRec_
d103 1
a103 3
    FT_ULong   offset;  /* not in file */

  } SFNT_HeaderRec, *SFNT_Header;
d109 1
a109 1
  /*    TT_TableDirRec                                                     */
d129 1
a129 1
  typedef struct  TT_TableDirRec_
d138 1
a138 1
  } TT_TableDirRec;
d144 1
a144 1
  /*    TT_TableRec                                                        */
d159 1
a159 1
  typedef struct  TT_TableRec_
d166 1
a166 1
  } TT_TableRec, *TT_Table;
d172 1
a172 1
  /*    TT_CMapDirRec                                                      */
d186 1
a186 1
  typedef struct  TT_CMapDirRec_
d191 1
a191 1
  } TT_CMapDirRec, *TT_CMapDir;
d197 1
a197 1
  /*    TT_CMapDirEntryRec                                                 */
d215 1
a215 1
  typedef struct  TT_CMapDirEntryRec_
d221 1
a221 1
  } TT_CMapDirEntryRec, *TT_CMapDirEntry;
d227 1
a227 1
  /*    TT_LongMetricsRec                                                  */
d238 1
a238 1
  typedef struct  TT_LongMetricsRec_
d243 1
a243 1
  } TT_LongMetricsRec, *TT_LongMetrics;
d248 1
a248 2
  /* <Type>                                                                */
  /*    TT_ShortMetrics                                                    */
d260 1
a260 1
  /*    TT_NameEntryRec                                                    */
d284 1
a284 1
  typedef struct  TT_NameEntryRec_
d291 1
a291 1
    FT_ULong   stringOffset;
d298 1
a298 1
  } TT_NameEntryRec, *TT_NameEntry;
d304 1
a304 1
  /*    TT_NameTableRec                                                    */
d319 1
a319 1
  /*    stream         :: the file's input stream.                         */
d321 1
a321 1
  typedef struct  TT_NameTableRec_
d323 5
a327 5
    FT_UShort         format;
    FT_UInt           numNameRecords;
    FT_UInt           storageOffset;
    TT_NameEntryRec*  names;
    FT_Stream         stream;
d329 1
a329 1
  } TT_NameTableRec, *TT_NameTable;
d348 1
a348 1
  /*    TT_GaspRangeRec                                                    */
d360 1
a360 1
  typedef struct  TT_GaspRangeRec_
d365 1
a365 1
  } TT_GaspRangeRec, *TT_GaspRange;
d375 1
a375 1
  /*    TT_GaspRec                                                         */
d390 3
a392 3
    FT_UShort     version;
    FT_UShort     numRanges;
    TT_GaspRange  gaspRanges;
d394 1
a394 1
  } TT_GaspRec;
d400 1
a400 1
  /*    TT_HdmxEntryRec                                                    */
d413 1
a413 1
  typedef struct  TT_HdmxEntryRec_
d419 1
a419 1
  } TT_HdmxEntryRec, *TT_HdmxEntry;
d425 1
a425 1
  /*    TT_HdmxRec                                                         */
d438 1
a438 1
  typedef struct  TT_HdmxRec_
d440 3
a442 3
    FT_UShort     version;
    FT_Short      num_records;
    TT_HdmxEntry  records;
d444 1
a444 1
  } TT_HdmxRec, *TT_Hdmx;
d450 1
a450 1
  /*    TT_Kern0_PairRec                                                   */
d465 1
a465 1
  typedef struct  TT_Kern0_PairRec_
d471 1
a471 1
  } TT_Kern0_PairRec, *TT_Kern0_Pair;
d490 1
a490 1
  /*    TT_SBit_MetricsRec                                                 */
d514 1
a514 1
  typedef struct  TT_SBit_MetricsRec_
d527 1
a527 1
  } TT_SBit_MetricsRec, *TT_SBit_Metrics;
d533 1
a533 1
  /*    TT_SBit_SmallMetricsRec                                            */
d560 1
a560 1
  } TT_SBit_SmallMetricsRec, *TT_SBit_SmallMetrics;
d566 1
a566 1
  /*    TT_SBit_LineMetricsRec                                             */
d614 1
a614 1
  typedef struct  TT_SBit_LineMetricsRec_
d628 1
a628 1
  } TT_SBit_LineMetricsRec, *TT_SBit_LineMetrics;
d634 1
a634 1
  /*    TT_SBit_RangeRec                                                   */
d668 1
a668 1
  typedef struct  TT_SBit_RangeRec
d670 2
a671 2
    FT_UShort           first_glyph;
    FT_UShort           last_glyph;
d673 3
a675 3
    FT_UShort           index_format;
    FT_UShort           image_format;
    FT_ULong            image_offset;
d677 3
a679 3
    FT_ULong            image_size;
    TT_SBit_MetricsRec  metrics;
    FT_ULong            num_glyphs;
d681 2
a682 2
    FT_ULong*           glyph_offsets;
    FT_UShort*          glyph_codes;
d684 1
a684 1
    FT_ULong            table_offset;
d686 1
a686 1
  } TT_SBit_RangeRec, *TT_SBit_Range;
d692 1
a692 1
  /*    TT_SBit_StrikeRec                                                  */
d732 1
a732 1
  typedef struct  TT_SBit_StrikeRec_
d734 3
a736 3
    FT_Int                  num_ranges;
    TT_SBit_Range           sbit_ranges;
    FT_ULong                ranges_offset;
d738 1
a738 1
    FT_ULong                color_ref;
d740 2
a741 2
    TT_SBit_LineMetricsRec  hori;
    TT_SBit_LineMetricsRec  vert;
d743 2
a744 2
    FT_UShort               start_glyph;
    FT_UShort               end_glyph;
d746 2
a747 2
    FT_Byte                 x_ppem;
    FT_Byte                 y_ppem;
d749 2
a750 2
    FT_Byte                 bit_depth;
    FT_Char                 flags;
d752 1
a752 1
  } TT_SBit_StrikeRec, *TT_SBit_Strike;
d758 1
a758 1
  /*    TT_SBit_ComponentRec                                               */
d770 1
a770 1
  typedef struct  TT_SBit_ComponentRec_
d776 1
a776 1
  } TT_SBit_ComponentRec, *TT_SBit_Component;
d782 1
a782 1
  /*    TT_SBit_ScaleRec                                                   */
d801 1
a801 1
  typedef struct  TT_SBit_ScaleRec_
d803 2
a804 2
    TT_SBit_LineMetricsRec  hori;
    TT_SBit_LineMetricsRec  vert;
d806 2
a807 2
    FT_Byte                 x_ppem;
    FT_Byte                 y_ppem;
d809 2
a810 2
    FT_Byte                 x_ppem_substitute;
    FT_Byte                 y_ppem_substitute;
d812 1
a812 1
  } TT_SBit_ScaleRec, *TT_SBit_Scale;
d831 1
a831 1
  /*    TT_Post_20Rec                                                      */
d846 1
a846 1
  typedef struct  TT_Post_20Rec_
d853 1
a853 1
  } TT_Post_20Rec, *TT_Post_20;
d859 1
a859 1
  /*    TT_Post_25Rec                                                      */
d876 1
a876 1
  } TT_Post_25Rec, *TT_Post_25;
d882 1
a882 1
  /*    TT_Post_NamesRec                                                   */
d894 1
a894 1
  typedef struct  TT_Post_NamesRec_
d896 1
a896 1
    FT_Bool  loaded;
d900 2
a901 2
      TT_Post_20Rec  format_20;
      TT_Post_25Rec  format_25;
d905 1
a905 1
  } TT_Post_NamesRec, *TT_Post_Names;
d929 1
a929 1
  } TT_CMap0Rec, *TT_CMap0;
d934 1
a934 1
  typedef struct  TT_CMap2SubHeaderRec_
d941 1
a941 1
  } TT_CMap2SubHeaderRec, *TT_CMap2SubHeader;
d944 1
a944 1
  typedef struct  TT_CMap2Rec_
d948 5
a952 3
    FT_UShort*          subHeaderKeys;  /* high byte mapping table     */
                                        /* value = subHeader index * 8 */
    TT_CMap2SubHeader   subHeaders;
d956 1
a956 1
  } TT_CMap2Rec, *TT_CMap2;
d968 1
a968 1
  } TT_CMap4SegmentRec, *TT_CMap4Segment;
d971 1
a971 1
  typedef struct  TT_CMap4Rec_
d973 1
a973 1
    FT_ULong         language;       /* for Mac fonts (originally ushort) */
d975 4
a978 4
    FT_UShort        segCountX2;     /* number of segments * 2            */
    FT_UShort        searchRange;    /* these parameters can be used      */
    FT_UShort        entrySelector;  /* for a binary search               */
    FT_UShort        rangeShift;
d980 3
a982 3
    TT_CMap4Segment  segments;
    FT_UShort*       glyphIdArray;
    FT_UShort        numGlyphId;     /* control value */
d984 1
a984 1
    TT_CMap4Segment  last_segment;   /* last used segment; this is a small  */
d986 1
a986 1
  } TT_CMap4Rec, *TT_CMap4;
d1000 1
a1000 1
  } TT_CMap6Rec, *TT_CMap6;
d1005 1
a1005 1
  typedef struct  TT_CMapGroupRec_
d1011 1
a1011 1
  } TT_CMapGroupRec, *TT_CMapGroup;
d1019 1
a1019 1
  typedef struct  TT_CMap8_12Rec_
d1021 1
a1021 1
    FT_ULong      language;        /* for Mac fonts */
d1023 2
a1024 2
    FT_ULong      nGroups;
    TT_CMapGroup  groups;
d1026 3
a1028 3
    TT_CMapGroup  last_group;      /* last used group; this is a small    */
                                   /* cache to potentially increase speed */
  } TT_CMap8_12Rec, *TT_CMap8_12;
d1033 1
a1033 1
  typedef struct  TT_CMap10Rec_
d1042 1
a1042 1
  } TT_CMap10Rec, *TT_CMap10;
d1045 1
a1045 1
  typedef struct TT_CMapTableRec_*  TT_CMapTable;
d1049 2
a1050 6
  (*TT_CharMap_Func)( TT_CMapTable  charmap,
                      FT_ULong      char_code );

  typedef FT_ULong
  (*TT_CharNext_Func)( TT_CMapTable  charmap,
                       FT_ULong      char_code );
d1054 1
a1054 1
  typedef struct  TT_CMapTableRec_
d1066 6
a1071 6
      TT_CMap0Rec     cmap0;
      TT_CMap2Rec     cmap2;
      TT_CMap4Rec     cmap4;
      TT_CMap6Rec     cmap6;
      TT_CMap8_12Rec  cmap8_12;
      TT_CMap10Rec    cmap10;
d1074 2
a1075 4
    TT_CharMap_Func   get_index;
    TT_CharNext_Func  get_next_char;

  } TT_CMapTableRec;
d1093 2
a1094 2
    FT_CharMapRec    root;
    TT_CMapTableRec  cmap;
d1118 1
a1118 1
  /* are not shared between font drivers, and are thus defined in          */
d1157 1
a1157 1
  typedef struct TT_LoaderRec_*  TT_Loader;
d1163 1
a1163 1
  /*    TT_Loader_GotoTableFunc                                            */
d1186 4
a1189 4
  (*TT_Loader_GotoTableFunc)( TT_Face    face,
                              FT_ULong   tag,
                              FT_Stream  stream,
                              FT_ULong*  length );
d1195 1
a1195 1
  /*    TT_Loader_StartGlyphFunc                                           */
d1215 3
a1217 3
  /*    This function is normally equivalent to FT_STREAM_SEEK(offset)     */
  /*    followed by FT_FRAME_ENTER(byte_count) with the loader's stream,   */
  /*    but alternative formats (e.g. compressed ones) might use something */
d1221 4
a1224 4
  (*TT_Loader_StartGlyphFunc)( TT_Loader  loader,
                               FT_UInt    glyph_index,
                               FT_ULong   offset,
                               FT_UInt    byte_count );
d1230 1
a1230 1
  /*    TT_Loader_ReadGlyphFunc                                            */
d1243 1
a1243 1
  (*TT_Loader_ReadGlyphFunc)( TT_Loader  loader );
d1249 1
a1249 1
  /*    TT_Loader_EndGlyphFunc                                             */
d1258 2
a1259 1
  (*TT_Loader_EndGlyphFunc)( TT_Loader  loader );
a1331 6
  /*    cmap_table           :: Address of the face's `cmap' SFNT table    */
  /*                            in memory (it's an extracted frame).       */
  /*                                                                       */
  /*    cmap_size            :: The size in bytes of the `cmap_table'      */
  /*                            described above.                           */
  /*                                                                       */
d1348 1
a1348 2
  /*    access_glyph_frame   :: A function used to access the frame of a   */
  /*                            given glyph within the face's font file.   */
d1350 1
a1350 2
  /*    forget_glyph_frame   :: A function used to forget the frame of a   */
  /*                            given glyph when all data has been loaded. */
d1352 5
a1356 11
  /*    read_glyph_header    :: A function used to read a glyph header.    */
  /*                            It must be called between an `access' and  */
  /*                            `forget'.                                  */
  /*                                                                       */
  /*    read_simple_glyph    :: A function used to read a simple glyph.    */
  /*                            It must be called after the header was     */
  /*                            read, and before the `forget'.             */
  /*                                                                       */
  /*    read_composite_glyph :: A function used to read a composite glyph. */
  /*                            It must be called after the header was     */
  /*                            read, and before the `forget'.             */
d1371 1
a1371 1
  /*    pclt                 :: The `pclt' SFNT table.                     */
d1428 4
a1431 2
  /*                            finds in the font file.  Ignored for       */
  /*                            Type 2 fonts.                              */
d1434 3
a1436 2
  /*                            kerning directory.  Ignored for Type 2     */
  /*                            fonts.                                     */
d1442 1
a1442 1
  /*    extra                :: Reserved for third-party font drivers.     */
d1446 1
a1446 1
    FT_FaceRec            root;
d1448 1
a1448 1
    TTC_HeaderRec         ttc_header;
d1450 3
a1452 3
    FT_ULong              format_tag;
    FT_UShort             num_tables;
    TT_Table              dir_tables;
d1454 2
a1455 2
    TT_Header             header;       /* TrueType header table          */
    TT_HoriHeader         horizontal;   /* TrueType horizontal header     */
d1457 2
a1458 2
    TT_MaxProfile         max_profile;
    FT_ULong              max_components;
d1460 2
a1461 2
    FT_Bool               vertical_info;
    TT_VertHeader         vertical;     /* TT Vertical header, if present */
d1463 2
a1464 2
    FT_UShort             num_names;    /* number of name records  */
    TT_NameTableRec       name_table;   /* name table              */
d1466 2
a1467 2
    TT_OS2                os2;          /* TrueType OS/2 table            */
    TT_Postscript         postscript;   /* TrueType Postscript table      */
d1469 2
a1470 2
    FT_Byte*              cmap_table;   /* extracted 'cmap' table */
    FT_ULong              cmap_size;
d1472 1
a1472 1
    TT_Loader_GotoTableFunc   goto_table;
d1474 5
a1478 5
    TT_Loader_StartGlyphFunc  access_glyph_frame;
    TT_Loader_EndGlyphFunc    forget_glyph_frame;
    TT_Loader_ReadGlyphFunc   read_glyph_header;
    TT_Loader_ReadGlyphFunc   read_simple_glyph;
    TT_Loader_ReadGlyphFunc   read_composite_glyph;
d1482 1
a1482 1
    void*                 sfnt;
d1486 1
a1486 1
    void*                 psnames;
d1495 1
a1495 1
    TT_HdmxRec            hdmx;
d1498 1
a1498 1
    TT_GaspRec            gasp;                 /* the `gasp' table */
d1501 1
a1501 1
    TT_PCLT               pclt;
d1504 2
a1505 2
    FT_ULong              num_sbit_strikes;
    TT_SBit_Strike        sbit_strikes;
d1507 2
a1508 2
    FT_ULong              num_sbit_scales;
    TT_SBit_Scale         sbit_scales;
d1511 1
a1511 1
    TT_Post_NamesRec      postscript_names;
d1521 2
a1522 2
    FT_UShort             num_locations;
    FT_Long*              glyph_locations;
d1525 2
a1526 2
    FT_ULong              font_program_size;
    FT_Byte*              font_program;
d1529 2
a1530 2
    FT_ULong              cvt_program_size;
    FT_Byte*              cvt_program;
d1533 2
a1534 2
    FT_ULong              cvt_size;
    FT_Short*             cvt;
d1537 3
a1539 3
    FT_Int                num_kern_pairs;
    FT_Int                kern_table_index;
    TT_Kern0_Pair         kern_pairs;
d1543 1
a1543 1
    TT_Interpreter        interpreter;
d1553 1
a1553 1
    FT_Generic            extra;
d1561 1
a1561 1
  /*     TT_GlyphZoneRec                                                   */
d1587 1
a1587 1
  typedef struct  TT_GlyphZoneRec_
d1601 1
a1601 1
  } TT_GlyphZoneRec, *TT_GlyphZone;
d1608 1
a1608 1
  typedef struct  TT_LoaderRec_
d1613 1
a1613 1
    FT_GlyphLoader   gloader;
d1634 2
a1635 2
    TT_GlyphZoneRec  base;
    TT_GlyphZoneRec  zone;
d1643 1
a1643 2

  } TT_LoaderRec;
@


1.1.1.1
log
@Import OpenBSD 3.3 XF4 repository from CTM 3132 the first time
This finalizes starting an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright  1968-2003  The authors of And contributors to UNIX, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@The X-Windowing System

Import XFree86 4.3 from OpenBSD by CTM, in the hope it's stable
@
text
@d8 1
a8 1
/*  Copyright 1996-2001, 2002 by                                           */
d48 1
a48 1
  /*    TTC_HeaderRec                                                      */
d66 1
a66 1
  typedef struct  TTC_HeaderRec_
d73 1
a73 1
  } TTC_HeaderRec;
d79 1
a79 1
  /*    SFNT_HeaderRec                                                     */
d89 1
a89 1
  /*    search_range   :: Must be `16 * (max power of 2 <= num_tables)'.   */
d91 1
a91 1
  /*    entry_selector :: Must be log2 of `search_range / 16'.             */
d93 1
a93 1
  /*    range_shift    :: Must be `num_tables * 16 - search_range'.        */
d95 1
a95 1
  typedef struct  SFNT_HeaderRec_
d103 1
a103 1
  } SFNT_HeaderRec, *SFNT_Header;
d109 1
a109 1
  /*    TT_TableDirRec                                                     */
d129 1
a129 1
  typedef struct  TT_TableDirRec_
d138 1
a138 1
  } TT_TableDirRec;
d144 1
a144 1
  /*    TT_TableRec                                                        */
d159 1
a159 1
  typedef struct  TT_TableRec_
d166 1
a166 1
  } TT_TableRec, *TT_Table;
d172 1
a172 1
  /*    TT_CMapDirRec                                                      */
d186 1
a186 1
  typedef struct  TT_CMapDirRec_
d191 1
a191 1
  } TT_CMapDirRec, *TT_CMapDir;
d197 1
a197 1
  /*    TT_CMapDirEntryRec                                                 */
d215 1
a215 1
  typedef struct  TT_CMapDirEntryRec_
d221 1
a221 1
  } TT_CMapDirEntryRec, *TT_CMapDirEntry;
d227 1
a227 1
  /*    TT_LongMetricsRec                                                  */
d238 1
a238 1
  typedef struct  TT_LongMetricsRec_
d243 1
a243 1
  } TT_LongMetricsRec, *TT_LongMetrics;
d248 1
a248 2
  /* <Type>                                                                */
  /*    TT_ShortMetrics                                                    */
d260 1
a260 1
  /*    TT_NameEntryRec                                                    */
d284 1
a284 1
  typedef struct  TT_NameEntryRec_
d291 1
a291 1
    FT_ULong   stringOffset;
d298 1
a298 1
  } TT_NameEntryRec, *TT_NameEntry;
d304 1
a304 1
  /*    TT_NameTableRec                                                    */
d319 1
a319 1
  /*    stream         :: the file's input stream.                         */
d321 1
a321 1
  typedef struct  TT_NameTableRec_
d323 5
a327 5
    FT_UShort         format;
    FT_UInt           numNameRecords;
    FT_UInt           storageOffset;
    TT_NameEntryRec*  names;
    FT_Stream         stream;
d329 1
a329 1
  } TT_NameTableRec, *TT_NameTable;
d348 1
a348 1
  /*    TT_GaspRangeRec                                                    */
d360 1
a360 1
  typedef struct  TT_GaspRangeRec_
d365 1
a365 1
  } TT_GaspRangeRec, *TT_GaspRange;
d375 1
a375 1
  /*    TT_GaspRec                                                         */
d390 3
a392 3
    FT_UShort     version;
    FT_UShort     numRanges;
    TT_GaspRange  gaspRanges;
d394 1
a394 1
  } TT_GaspRec;
d400 1
a400 1
  /*    TT_HdmxEntryRec                                                    */
d413 1
a413 1
  typedef struct  TT_HdmxEntryRec_
d419 1
a419 1
  } TT_HdmxEntryRec, *TT_HdmxEntry;
d425 1
a425 1
  /*    TT_HdmxRec                                                         */
d438 1
a438 1
  typedef struct  TT_HdmxRec_
d440 3
a442 3
    FT_UShort     version;
    FT_Short      num_records;
    TT_HdmxEntry  records;
d444 1
a444 1
  } TT_HdmxRec, *TT_Hdmx;
d450 1
a450 1
  /*    TT_Kern0_PairRec                                                   */
d465 1
a465 1
  typedef struct  TT_Kern0_PairRec_
d471 1
a471 1
  } TT_Kern0_PairRec, *TT_Kern0_Pair;
d490 1
a490 1
  /*    TT_SBit_MetricsRec                                                 */
d514 1
a514 1
  typedef struct  TT_SBit_MetricsRec_
d527 1
a527 1
  } TT_SBit_MetricsRec, *TT_SBit_Metrics;
d533 1
a533 1
  /*    TT_SBit_SmallMetricsRec                                            */
d560 1
a560 1
  } TT_SBit_SmallMetricsRec, *TT_SBit_SmallMetrics;
d566 1
a566 1
  /*    TT_SBit_LineMetricsRec                                             */
d614 1
a614 1
  typedef struct  TT_SBit_LineMetricsRec_
d628 1
a628 1
  } TT_SBit_LineMetricsRec, *TT_SBit_LineMetrics;
d634 1
a634 1
  /*    TT_SBit_RangeRec                                                   */
d668 1
a668 1
  typedef struct  TT_SBit_RangeRec
d670 2
a671 2
    FT_UShort           first_glyph;
    FT_UShort           last_glyph;
d673 3
a675 3
    FT_UShort           index_format;
    FT_UShort           image_format;
    FT_ULong            image_offset;
d677 3
a679 3
    FT_ULong            image_size;
    TT_SBit_MetricsRec  metrics;
    FT_ULong            num_glyphs;
d681 2
a682 2
    FT_ULong*           glyph_offsets;
    FT_UShort*          glyph_codes;
d684 1
a684 1
    FT_ULong            table_offset;
d686 1
a686 1
  } TT_SBit_RangeRec, *TT_SBit_Range;
d692 1
a692 1
  /*    TT_SBit_StrikeRec                                                  */
d732 1
a732 1
  typedef struct  TT_SBit_StrikeRec_
d734 3
a736 3
    FT_Int                  num_ranges;
    TT_SBit_Range           sbit_ranges;
    FT_ULong                ranges_offset;
d738 1
a738 1
    FT_ULong                color_ref;
d740 2
a741 2
    TT_SBit_LineMetricsRec  hori;
    TT_SBit_LineMetricsRec  vert;
d743 2
a744 2
    FT_UShort               start_glyph;
    FT_UShort               end_glyph;
d746 2
a747 2
    FT_Byte                 x_ppem;
    FT_Byte                 y_ppem;
d749 2
a750 2
    FT_Byte                 bit_depth;
    FT_Char                 flags;
d752 1
a752 1
  } TT_SBit_StrikeRec, *TT_SBit_Strike;
d758 1
a758 1
  /*    TT_SBit_ComponentRec                                               */
d770 1
a770 1
  typedef struct  TT_SBit_ComponentRec_
d776 1
a776 1
  } TT_SBit_ComponentRec, *TT_SBit_Component;
d782 1
a782 1
  /*    TT_SBit_ScaleRec                                                   */
d801 1
a801 1
  typedef struct  TT_SBit_ScaleRec_
d803 2
a804 2
    TT_SBit_LineMetricsRec  hori;
    TT_SBit_LineMetricsRec  vert;
d806 2
a807 2
    FT_Byte                 x_ppem;
    FT_Byte                 y_ppem;
d809 2
a810 2
    FT_Byte                 x_ppem_substitute;
    FT_Byte                 y_ppem_substitute;
d812 1
a812 1
  } TT_SBit_ScaleRec, *TT_SBit_Scale;
d831 1
a831 1
  /*    TT_Post_20Rec                                                      */
d846 1
a846 1
  typedef struct  TT_Post_20Rec_
d853 1
a853 1
  } TT_Post_20Rec, *TT_Post_20;
d859 1
a859 1
  /*    TT_Post_25Rec                                                      */
d876 1
a876 1
  } TT_Post_25Rec, *TT_Post_25;
d882 1
a882 1
  /*    TT_Post_NamesRec                                                   */
d894 1
a894 1
  typedef struct  TT_Post_NamesRec_
d896 1
a896 1
    FT_Bool  loaded;
d900 2
a901 2
      TT_Post_20Rec  format_20;
      TT_Post_25Rec  format_25;
d905 1
a905 1
  } TT_Post_NamesRec, *TT_Post_Names;
d929 1
a929 1
  } TT_CMap0Rec, *TT_CMap0;
d934 1
a934 1
  typedef struct  TT_CMap2SubHeaderRec_
d941 1
a941 1
  } TT_CMap2SubHeaderRec, *TT_CMap2SubHeader;
d944 1
a944 1
  typedef struct  TT_CMap2Rec_
d948 5
a952 3
    FT_UShort*          subHeaderKeys;  /* high byte mapping table     */
                                        /* value = subHeader index * 8 */
    TT_CMap2SubHeader   subHeaders;
d956 1
a956 1
  } TT_CMap2Rec, *TT_CMap2;
d968 1
a968 1
  } TT_CMap4SegmentRec, *TT_CMap4Segment;
d971 1
a971 1
  typedef struct  TT_CMap4Rec_
d973 1
a973 1
    FT_ULong         language;       /* for Mac fonts (originally ushort) */
d975 4
a978 4
    FT_UShort        segCountX2;     /* number of segments * 2            */
    FT_UShort        searchRange;    /* these parameters can be used      */
    FT_UShort        entrySelector;  /* for a binary search               */
    FT_UShort        rangeShift;
d980 3
a982 3
    TT_CMap4Segment  segments;
    FT_UShort*       glyphIdArray;
    FT_UShort        numGlyphId;     /* control value */
d984 1
a984 1
    TT_CMap4Segment  last_segment;   /* last used segment; this is a small  */
d986 1
a986 1
  } TT_CMap4Rec, *TT_CMap4;
d1000 1
a1000 1
  } TT_CMap6Rec, *TT_CMap6;
d1005 1
a1005 1
  typedef struct  TT_CMapGroupRec_
d1011 1
a1011 1
  } TT_CMapGroupRec, *TT_CMapGroup;
d1019 1
a1019 1
  typedef struct  TT_CMap8_12Rec_
d1021 1
a1021 1
    FT_ULong      language;        /* for Mac fonts */
d1023 2
a1024 2
    FT_ULong      nGroups;
    TT_CMapGroup  groups;
d1026 3
a1028 3
    TT_CMapGroup  last_group;      /* last used group; this is a small    */
                                   /* cache to potentially increase speed */
  } TT_CMap8_12Rec, *TT_CMap8_12;
d1033 1
a1033 1
  typedef struct  TT_CMap10Rec_
d1042 1
a1042 1
  } TT_CMap10Rec, *TT_CMap10;
d1045 1
a1045 1
  typedef struct TT_CMapTableRec_*  TT_CMapTable;
d1049 2
a1050 6
  (*TT_CharMap_Func)( TT_CMapTable  charmap,
                      FT_ULong      char_code );

  typedef FT_ULong
  (*TT_CharNext_Func)( TT_CMapTable  charmap,
                       FT_ULong      char_code );
d1054 1
a1054 1
  typedef struct  TT_CMapTableRec_
d1066 6
a1071 6
      TT_CMap0Rec     cmap0;
      TT_CMap2Rec     cmap2;
      TT_CMap4Rec     cmap4;
      TT_CMap6Rec     cmap6;
      TT_CMap8_12Rec  cmap8_12;
      TT_CMap10Rec    cmap10;
d1074 2
a1075 4
    TT_CharMap_Func   get_index;
    TT_CharNext_Func  get_next_char;

  } TT_CMapTableRec;
d1093 2
a1094 2
    FT_CharMapRec    root;
    TT_CMapTableRec  cmap;
d1118 1
a1118 1
  /* are not shared between font drivers, and are thus defined in          */
d1157 1
a1157 1
  typedef struct TT_LoaderRec_*  TT_Loader;
d1163 1
a1163 1
  /*    TT_Loader_GotoTableFunc                                            */
d1186 4
a1189 4
  (*TT_Loader_GotoTableFunc)( TT_Face    face,
                              FT_ULong   tag,
                              FT_Stream  stream,
                              FT_ULong*  length );
d1195 1
a1195 1
  /*    TT_Loader_StartGlyphFunc                                           */
d1215 3
a1217 3
  /*    This function is normally equivalent to FT_STREAM_SEEK(offset)     */
  /*    followed by FT_FRAME_ENTER(byte_count) with the loader's stream,   */
  /*    but alternative formats (e.g. compressed ones) might use something */
d1221 4
a1224 4
  (*TT_Loader_StartGlyphFunc)( TT_Loader  loader,
                               FT_UInt    glyph_index,
                               FT_ULong   offset,
                               FT_UInt    byte_count );
d1230 1
a1230 1
  /*    TT_Loader_ReadGlyphFunc                                            */
d1243 1
a1243 1
  (*TT_Loader_ReadGlyphFunc)( TT_Loader  loader );
d1249 1
a1249 1
  /*    TT_Loader_EndGlyphFunc                                             */
d1258 2
a1259 1
  (*TT_Loader_EndGlyphFunc)( TT_Loader  loader );
a1331 6
  /*    cmap_table           :: Address of the face's `cmap' SFNT table    */
  /*                            in memory (it's an extracted frame).       */
  /*                                                                       */
  /*    cmap_size            :: The size in bytes of the `cmap_table'      */
  /*                            described above.                           */
  /*                                                                       */
d1348 5
a1352 2
  /*    access_glyph_frame   :: A function used to access the frame of a   */
  /*                            given glyph within the face's font file.   */
d1354 1
a1354 2
  /*    forget_glyph_frame   :: A function used to forget the frame of a   */
  /*                            given glyph when all data has been loaded. */
d1356 1
a1356 11
  /*    read_glyph_header    :: A function used to read a glyph header.    */
  /*                            It must be called between an `access' and  */
  /*                            `forget'.                                  */
  /*                                                                       */
  /*    read_simple_glyph    :: A function used to read a simple glyph.    */
  /*                            It must be called after the header was     */
  /*                            read, and before the `forget'.             */
  /*                                                                       */
  /*    read_composite_glyph :: A function used to read a composite glyph. */
  /*                            It must be called after the header was     */
  /*                            read, and before the `forget'.             */
d1371 1
a1371 1
  /*    pclt                 :: The `pclt' SFNT table.                     */
d1428 4
a1431 2
  /*                            finds in the font file.  Ignored for       */
  /*                            Type 2 fonts.                              */
d1434 3
a1436 2
  /*                            kerning directory.  Ignored for Type 2     */
  /*                            fonts.                                     */
d1442 1
a1442 1
  /*    extra                :: Reserved for third-party font drivers.     */
d1446 1
a1446 3
    FT_FaceRec            root;

    TTC_HeaderRec         ttc_header;
d1448 1
a1448 3
    FT_ULong              format_tag;
    FT_UShort             num_tables;
    TT_Table              dir_tables;
d1450 3
a1452 2
    TT_Header             header;       /* TrueType header table          */
    TT_HoriHeader         horizontal;   /* TrueType horizontal header     */
d1454 2
a1455 2
    TT_MaxProfile         max_profile;
    FT_ULong              max_components;
d1457 2
a1458 2
    FT_Bool               vertical_info;
    TT_VertHeader         vertical;     /* TT Vertical header, if present */
d1460 2
a1461 2
    FT_UShort             num_names;    /* number of name records  */
    TT_NameTableRec       name_table;   /* name table              */
d1463 2
a1464 2
    TT_OS2                os2;          /* TrueType OS/2 table            */
    TT_Postscript         postscript;   /* TrueType Postscript table      */
d1466 2
a1467 1
#ifdef FT_CONFIG_OPTION_USE_CMAPS
d1469 2
a1470 2
    FT_Byte*              cmap_table;   /* extracted 'cmap' table */
    FT_ULong              cmap_size;
d1472 1
a1472 1
#else /* !FT_CONFIG_OPTION_USE_CMAPS */
d1474 5
a1478 12
    FT_Int                num_charmaps;
    TT_CharMap            charmaps;     /* array of TT_CharMapRec */

#endif /* !FT_CONFIG_OPTION_USE_CMAPS */

    TT_Loader_GotoTableFunc   goto_table;

    TT_Loader_StartGlyphFunc  access_glyph_frame;
    TT_Loader_EndGlyphFunc    forget_glyph_frame;
    TT_Loader_ReadGlyphFunc   read_glyph_header;
    TT_Loader_ReadGlyphFunc   read_simple_glyph;
    TT_Loader_ReadGlyphFunc   read_composite_glyph;
d1482 1
a1482 1
    void*                 sfnt;
d1486 1
a1486 1
    void*                 psnames;
d1495 1
a1495 1
    TT_HdmxRec            hdmx;
d1498 1
a1498 1
    TT_GaspRec            gasp;                 /* the `gasp' table */
d1501 1
a1501 1
    TT_PCLT               pclt;
d1504 2
a1505 2
    FT_Int                num_sbit_strikes;
    TT_SBit_Strike        sbit_strikes;
d1507 2
a1508 2
    FT_Int                num_sbit_scales;
    TT_SBit_Scale         sbit_scales;
d1511 1
a1511 1
    TT_Post_NamesRec      postscript_names;
d1521 2
a1522 2
    FT_UShort             num_locations;
    FT_Long*              glyph_locations;
d1525 2
a1526 2
    FT_ULong              font_program_size;
    FT_Byte*              font_program;
d1529 2
a1530 2
    FT_ULong              cvt_program_size;
    FT_Byte*              cvt_program;
d1533 2
a1534 2
    FT_ULong              cvt_size;
    FT_Short*             cvt;
d1537 3
a1539 3
    FT_Int                num_kern_pairs;
    FT_Int                kern_table_index;
    TT_Kern0_Pair         kern_pairs;
d1543 1
a1543 1
    TT_Interpreter        interpreter;
d1553 1
a1553 1
    FT_Generic            extra;
d1561 1
a1561 1
  /*     TT_GlyphZoneRec                                                   */
d1587 1
a1587 1
  typedef struct  TT_GlyphZoneRec_
d1601 1
a1601 1
  } TT_GlyphZoneRec, *TT_GlyphZone;
d1608 1
a1608 1
  typedef struct  TT_LoaderRec_
d1613 1
a1613 1
    FT_GlyphLoader   gloader;
d1634 2
a1635 2
    TT_GlyphZoneRec  base;
    TT_GlyphZoneRec  zone;
d1643 1
a1643 2

  } TT_LoaderRec;
@


1.1.1.3
log
@That's what OpenBSD will, probably, ship as XF4 in 3.5
their last sync against XFree86 4.3-current has been
imported into our vendor branch, too
@
text
@a102 2
    FT_ULong   offset;  /* not in file */

d1484 2
d1489 7
d1528 1
a1528 1
    FT_ULong              num_sbit_strikes;
d1531 1
a1531 1
    FT_ULong              num_sbit_scales;
@


