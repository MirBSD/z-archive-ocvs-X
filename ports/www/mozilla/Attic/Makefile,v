head	1.20;
access;
symbols
	cvs-200405281530:1.1.1.16
	cvs-200402211630:1.1.1.15
	cvs-200401261625:1.1.1.14
	cvs-200401162142:1.1.1.13
	cvs-200301141450:1.1.1.13
	cvs-200312021610:1.1.1.12
	cvs-200311151930:1.1.1.12
	cvs-200310311830:1.1.1.12
	cvs-200310021000:1.1.1.11
	cvs-200309281111:1.1.1.11
	cvs-200309171515:1.1.1.11
	cvs-200308302005:1.1.1.10
	cvs-200308171200:1.1.1.9
	ctm-3449:1.1.1.9
	cvs-200307191610:1.1.1.8
	ctm-3416:1.1.1.7
	cvs-200307091500:1.1.1.7
	ctm-3389:1.1.1.7
	cvs-200306291800:1.1.1.6
	ctm-3369:1.1.1.6
	ctm-3341:1.1.1.5
	MIRBSD_5:1.5
	cvs-200306082100:1.1.1.5
	ctm-3316:1.1.1.4
	ctm-3272:1.1.1.3
	ctm-3264:1.1.1.2
	ctm-3258:1.1.1.2
	MIRBSD_4:1.1.1.2
	ctm-3200:1.1.1.2
	ctm-3188:1.1.1.1
	ctm-3155:1.1.1.1
	ctm-3132:1.1.1.1
	openbsd:1.1.1;
locks; strict;
comment	@# @;


1.20
date	2004.06.28.16.50.42;	author tg;	state dead;
branches;
next	1.19;

1.19
date	2004.06.02.12.41.28;	author bsiegert;	state Exp;
branches;
next	1.18;

1.18
date	2004.05.31.11.53.10;	author bsiegert;	state Exp;
branches;
next	1.17;

1.17
date	2004.04.20.18.45.08;	author tg;	state Exp;
branches;
next	1.16;

1.16
date	2004.02.22.14.05.16;	author bsiegert;	state Exp;
branches;
next	1.15;

1.15
date	2004.02.15.22.10.39;	author bsiegert;	state Exp;
branches;
next	1.14;

1.14
date	2004.02.06.01.36.26;	author tg;	state Exp;
branches;
next	1.13;

1.13
date	2004.01.26.23.07.53;	author bsiegert;	state Exp;
branches;
next	1.12;

1.12
date	2004.01.15.21.15.37;	author tg;	state Exp;
branches;
next	1.11;

1.11
date	2003.10.31.21.53.37;	author tg;	state Exp;
branches;
next	1.10;

1.10
date	2003.10.17.16.28.22;	author tg;	state Exp;
branches;
next	1.9;

1.9
date	2003.09.17.16.58.12;	author tg;	state Exp;
branches;
next	1.8;

1.8
date	2003.08.31.20.53.50;	author tg;	state Exp;
branches;
next	1.7;

1.7
date	2003.07.06.20.19.16;	author tg;	state Exp;
branches;
next	1.6;

1.6
date	2003.06.29.01.04.31;	author tg;	state Exp;
branches;
next	1.5;

1.5
date	2003.06.09.02.25.18;	author tg;	state Exp;
branches;
next	1.4;

1.4
date	2003.06.06.17.39.27;	author tg;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.22.13.28.25;	author tg;	state Exp;
branches;
next	1.2;

1.2
date	2003.05.15.15.19.52;	author tg;	state Exp;
branches;
next	1.1;

1.1
date	2003.03.22.19.54.35;	author tg;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.03.22.19.54.35;	author tg;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2003.04.14.15.29.22;	author tg;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2003.05.21.18.27.46;	author tg;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2003.06.05.16.50.42;	author tg;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2003.06.08.23.22.59;	author tg;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2003.06.29.00.07.22;	author tg;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2003.07.06.13.44.59;	author tg;	state Exp;
branches;
next	1.1.1.8;

1.1.1.8
date	2003.07.19.17.11.17;	author tg;	state Exp;
branches;
next	1.1.1.9;

1.1.1.9
date	2003.07.26.13.48.21;	author tg;	state Exp;
branches;
next	1.1.1.10;

1.1.1.10
date	2003.08.30.21.49.13;	author tg;	state Exp;
branches;
next	1.1.1.11;

1.1.1.11
date	2003.09.17.16.08.49;	author tg;	state Exp;
branches;
next	1.1.1.12;

1.1.1.12
date	2003.10.31.19.27.34;	author tg;	state Exp;
branches;
next	1.1.1.13;

1.1.1.13
date	2004.01.14.16.00.37;	author tg;	state Exp;
branches;
next	1.1.1.14;

1.1.1.14
date	2004.01.26.18.07.20;	author bsiegert;	state Exp;
branches;
next	1.1.1.15;

1.1.1.15
date	2004.02.21.17.10.30;	author bsiegert;	state Exp;
branches;
next	1.1.1.16;

1.1.1.16
date	2004.05.28.16.16.46;	author bsiegert;	state Exp;
branches;
next	;


desc
@@


1.20
log
@The Mozilla(TM) and Firefox(TM) trademarks prevent us from distributing
these ports, and the Firebird is not a trademark.

New ports being expected are:
 - ports/www/bloatzilla
 - ports/www/firesomething (or ports/www/firewhat; I'll leave
   it up to the maintainer)

Found by Theo de Raadt on the debian-legal list
@
text
@# $MirBSD: ports/www/mozilla/Makefile,v 1.19 2004/06/02 12:41:28 bsiegert Exp $
# $OpenBSD: Makefile,v 1.72 2004/05/06 14:39:49 wilfried Exp $

_VERCHECK_MAJOR=7
_VERCHECK_MINOR=160
.include <bsd.port.ver.mk>
.if ${_VERCHECK_VALUE} == "2"
IGNORE=		needs newer MirOS version
.endif

ONLY_FOR_ARCHS= alpha i386 sparc sparc64 amd64 powerpc

COMMENT=	"open source version of the Netscape browser"
COMMENT-devel=	"devel files for Gecko"
VER=		1.6
DISTNAME=	mozilla
PKGNAME=	mozilla-${VER}
DISTFILES=	mozilla-source-${VER}.tar.bz2
CATEGORIES=	www
HOMEPAGE=	http://www.mozilla.org/

RESPONSIBLE=	Benny Siegert <bsiegert@@gmx.de>

# mozilla public license
PERMIT_PACKAGE_CDROM=	Yes
PERMIT_PACKAGE_FTP=	Yes
PERMIT_DISTFILES_CDROM=	Yes
PERMIT_DISTFILES_FTP=	Yes

MASTER_SITES=	http://ftp.eu.mozilla.org/pub/mozilla.org/mozilla/releases/mozilla${VER}/src/ \
		http://ftp.mozilla.org/pub/mozilla/releases/mozilla${VER}/src/

MULTI_PACKAGES=	-devel

VMEM_WARNING=	yes

.for i in ${MULTI_PACKAGES}
PKGNAME$i=	mozilla${i}-${VER}
.endfor

SUBPACKAGE?=

.if ${SUBPACKAGE} == "-devel"
RUN_DEPENDS=	::www/mozilla
.else
BUILD_DEPENDS=	:zip->=2.3:archivers/zip \
		:pkgconfig-*:devel/pkgconfig
LIB_DEPENDS=	gtk.1,gdk.1::x11/gtk+ \
		IDL.4::devel/ORBit \
		jpeg.62::graphics/jpeg \
		png.3::graphics/png
.endif

USE_CXX=	Yes
USE_X11=	Yes
USE_GMAKE=	Yes
# Regression tests are too hard to adapt to run here
NO_REGRESS=	Yes

AUTOCONF_VERSION= 2.13
CONFIGURE_STYLE= autoconf no-autoheader
CONFIGURE_ARGS=					\
		--with-system-jpeg=${LOCALBASE}	\
		--with-system-png=${LOCALBASE}	\
		--with-system-zlib=/usr/lib	\
		--with-pthreads			\
		--enable-xft			\
		--enable-optimize=-Os		\
		--enable-crypto			\
		--enable-extensions=default	\
		--disable-pedantic		\
		--disable-debug			\
		--disable-tests			\
		--disable-ldap

CONFIGURE_ARGS+=--host=${AUTOCONF_FAKEOS}
# There is no problem with the propolice-enabled gcc3 on amd64 and sparc64,
# but it is reported to still be broken on others.
.if ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "sparc64"
CFLAGS+=	-fno-stack-protector
.endif

CONFIGURE_ENV=	PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig"
MAKE_ENV=	LD_LIBRARY_PATH="${WRKSRC}/dist/bin"

MOB=		${WRKSRC}/dist
MOZ=		${PREFIX}/mozilla

post-extract:
	@@cp ${FILESDIR}/xptc* ${WRKSRC}/xpcom/reflect/xptcall/src/md/unix/

pre-configure:
	@@cd ${WRKSRC}/nsprpub && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g; s|_X11BASE_|${X11BASE}|g' \
		${WRKSRC}/xpfe/bootstrap/mozilla.in

do-install:
.for dir in include lib
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
	@@cd ${MOB} && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
	@@cd ${MOB}/public && ${TAR} -chf - nss | \
		${TAR} -xf - -C ${MOZ}/include
.for dir in chrome components defaults res searchplugins
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
	@@cd ${MOB}/bin && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
	@@cd ${MOB}/bin && ${TAR} -chf - *.so.1.0 | \
		${TAR} -xf - -C ${MOZ}
	@@chmod 444 ${MOZ}/*.so.1.0 ${MOZ}/components/*.so.1.0
	${INSTALL_DATA} ${MOB}/bin/LICENSE ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/bin/mozilla ${PREFIX}/bin
	${INSTALL_SCRIPT} ${MOB}/bin/run-mozilla.sh ${MOB}/bin/mozilla-config ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/bin/regchrome ${MOB}/bin/regxpcom ${MOB}/bin/mozilla-bin ${MOZ}
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications
	${INSTALL_DATA_DIR} ${PREFIX}/share/pixmaps
.for file in mozilla mozilla-mail mozilla-compose
	${INSTALL_DATA} ${WRKSRC}/build/package/rpm/SOURCES/${file}.desktop ${PREFIX}/share/applications
	${INSTALL_DATA} ${WRKSRC}/build/package/rpm/SOURCES/${file}-icon.* ${PREFIX}/share/pixmaps
.endfor
	${INSTALL_DATA_DIR} ${PREFIX}/lib/pkgconfig
	${INSTALL_DATA} ${WRKBUILD}/build/unix/*.pc ${PREFIX}/lib/pkgconfig

.include <bsd.port.mk>
@


1.19
log
@Remove gcc3 module invocations, hope I catched all.
@
text
@d1 1
a1 1
# $MirBSD: ports/www/mozilla/Makefile,v 1.18 2004/05/31 11:53:10 bsiegert Exp $
@


1.18
log
@Merge www and x11.

www/mod_perl: Remove apostrophe error in Makefile.
www/mozilla: Change BROKEN to IGNORE.
www/mozilla-firefox: still BROKEN for now.
www/tidy: Not merged (tg?).
x11/icewm: Not merged (tg?).
x11/ion: Needs testing.
x11/mplayer: Not merged (tg?).
x11/tk/8.4: Needs testing.
x11/wxgtk: Not removed.
@
text
@d1 1
a1 1
# $MirBSD: ports/www/mozilla/Makefile,v 1.17 2004/04/20 18:45:08 tg Exp $
a45 3
MODULES=	gcc3
MODGCC3_ARCHES=	alpha powerpc
MODGCC3_LANGS=	C++
@


1.17
log
@* mark mozilla, firebird and firefox as broken on old MirOS
* mark firefox as broken because it's not fixed/ported yet
  (will come later)
* nuke MODGCC3 from firebird while here
@
text
@d1 2
a2 2
# $MirBSD: Makefile,v 1.16 2004/02/22 14:05:16 bsiegert Exp $
# $OpenBSD: Makefile,v 1.66 2004/02/15 19:44:01 wilfried Exp $
d8 1
a8 1
BROKEN=		needs newer MirOS version
d11 1
a11 1
ONLY_FOR_ARCHS=	i386 sparc sparc64
d47 1
a47 1
MODGCC3_ARCHES=	alpha sparc64
a51 1
		glib.1,gmodule.1::devel/glib \
d63 2
a64 1
CONFIGURE_STYLE= autoconf
d80 3
d84 2
@


1.16
log
@Tray again to import my changes into www/.

odem (Thorsten's laptop) crashed shortly after committing this. The data
to be committed hat not yet been fully written. Hope everything is OK now.
@
text
@d1 1
a1 1
# $MirBSD: Makefile,v 1.16 2004/02/21 23:09:03 bsiegert Exp $
d3 7
@


1.15
log
@Mozilla 1.6 now works, too. I am daring now, I put myself in as
RESPONSIBLE.
@
text
@d1 2
a2 2
# $MirBSD: Makefile,v 1.14 2004/02/06 01:36:26 tg Exp $
# $OpenBSD: Makefile,v 1.64 2004/01/19 14:36:48 wilfried Exp $
d23 2
a24 1
MASTER_SITES=	http://ftp.mozilla.org/pub/mozilla/releases/mozilla${VER}/src/
d40 1
a40 1
MODGCC3_ARCHES=	alpha sparc64 powerpc
d64 1
a64 1
		--enable-optimize=-O2		\
d94 3
a96 1
.for dir in chrome components defaults icons res plugins searchplugins
d103 1
@


1.14
log
@sync
@
text
@d1 1
a1 1
# $MirBSD: Makefile,v 1.13 2004/01/26 23:07:53 bsiegert Exp $
a3 1
BROKEN=		untested, should fail the same as mozilla-firebird
d14 2
@


1.13
log
@
Resolve conflicts from last import.

Please test, especially bochs, snownews et al. bsd.port.mk was deliberately
left out, this is up to tg.
@
text
@d1 1
a1 1
# $MirBSD: Makefile,v 1.12 2004/01/15 21:15:37 tg Exp $
d4 2
a5 3
USE_CXX=	Yes
BROKEN=		'gmake[4]: gcc: Command not found (and core dump)'
ONLY_FOR_ARCHS= alpha i386 sparc sparc64
a8 1

a12 1

a13 1

d26 1
a26 1
VMEM_WARNING=yes
d49 1
d70 1
@


1.12
log
@finish merging Ports, except for
* www/snownews
* x11/gnome

Please start merging these now, and tell OK in IRC
@
text
@d1 2
a2 2
# $MirBSD: Makefile,v 1.11 2003/10/31 21:53:37 tg Exp $
# $OpenBSD: Makefile,v 1.62 2003/12/04 15:01:38 wilfried Exp $
d11 1
a11 1
VER=		1.6a
d44 2
a45 1
BUILD_DEPENDS=	:zip->=2.3:archivers/zip
d64 2
d74 1
d85 1
a85 1
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g' \
@


1.11
log
@Merge 'cvs import'

* Please, everyone, make sure your ports still work.

  This includes:
  * gnome 2.4.1(sic!) - a few USE_CXX may have vanished by accident *oops*
  * centericq
  * pine

* The ports tree is still locked until ports/INDEX is committed
  with the unlock message
@
text
@d1 2
a2 2
# $MirBSD: Makefile,v 1.10 2003/10/17 16:28:22 tg Exp $
# $OpenBSD: Makefile,v 1.61 2003/10/18 19:44:47 sturm Exp $
d11 1
a11 1
VER=		1.4
d49 1
a49 2
		png.3::graphics/png \
		mng.1::graphics/libmng
a59 1
		--with-system-mng=${LOCALBASE}	\
d107 2
@


1.10
log
@break bloatzilla*, it does not honour ${CC}.
i'm not going to dive into this.
@
text
@d1 2
a2 2
# $MirBSD$
# $OpenBSD: Makefile,v 1.59 2003/09/03 17:35:47 pvalchev Exp $
d5 2
a6 2
NOT_FOR_ARCHS=	vax m68k hppa powerpc
BROKEN=		gmake[4]: gcc: Command not found
d20 1
@


1.9
log
@Merge OpenBSD ports tree into MirPorts
@
text
@d1 1
d6 1
@


1.8
log
@Merge import of OpenBSD source, ports and XF4 tree.

While here,
o clean up differences where possible
o whitespace cleanup
o ifdef ./. if defined()
o '...' ./. "..."
o echo foo > bar ./. echo foo >bar
o `...` ./. $(...) ./. $$(...)
o `...' ./. '...'
o modernize "our" tree, e.g. WWW in ports
o fix some typos and brainos introduced when renaming OpenBSD to MirBSD
o use hardware 80387 by default
o migrate Apache 1.3.28 OpenBSD ./. MirBSD ./. KAME
o work around as many CVS bugs as possible (add back/delete files, ...)

Synchronize stuff, ready for ongoing changes.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2003/08/18 14:22:12 wilfried Exp $
a2 1
NOT_FOR_ARCHS=	vax m68k hppa
d4 1
@


1.7
log
@mop up
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.54 2003/07/04 06:59:15 marcm Exp $
d4 1
d27 2
d39 1
a39 1
MODGCC3_ARCHES=	sparc64
d75 3
a106 1
BROKEN=	Mozilla does not work on OpenBSD and will never do
@


1.6
log
@merge import
@
text
@d1 3
a3 1
# $OpenBSD: Makefile,v 1.50 2003/06/25 12:01:16 wilfried Exp $
d8 1
a8 1
VER=		1.4b
d49 2
d94 6
@


1.5
log
@merge cvs
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2003/06/06 12:50:30 wilfried Exp $
d70 2
d89 1
a89 1
	${INSTALL_PROGRAM} ${MOB}/bin/regxpcom ${MOB}/bin/mozilla-bin ${MOZ}
@


1.4
log
@sync with OpenBSD

NB: mozilla is marked "broken". rumour has it that
    you can build it with NO_IGNORE, but i won't unbreak that beast.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.47 2003/06/02 07:05:56 pvalchev Exp $
d86 1
a86 1
	${INSTALL_SCRIPT} ${MOB}/bin/run-mozilla.sh ${MOZ}
@


1.3
log
@merge CVS import conflicts
@
text
@d1 1
a1 2
# $OpenBSD: Makefile,v 1.42 2003/05/18 20:41:19 wilfried Exp $
# Uses pthreads
d4 1
d22 12
a33 2
MODULES=	iconv
MODULES+=	gcc3
d43 1
d56 2
a59 1
		--disable-profilesharing	\
a60 2
# enable these once Mozilla actually runs
#		--enable-optimize="${CFLAGS}"	\
d62 2
a63 3
CONFIGURE_ENV=	CFLAGS="" CXXFLAGS=""
MAKE_ENV=	LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
		CFLAGS="" CXXFLAGS=""
d65 1
a65 1
MOB=		${WRKSRC}/dist/bin
d72 5
a76 1
	${INSTALL_DATA_DIR} ${MOZ}
d78 2
a79 1
	@@cd ${MOB} && ${TAR} -chf - ${dir} | \
d82 1
a82 1
	@@cd ${MOB} && ${TAR} -chf - *.so.1.0 | \
d84 4
a87 3
	${INSTALL_SCRIPT} ${MOB}/mozilla ${MOB}/run-mozilla.sh ${PREFIX}/bin
	${INSTALL_DATA} ${MOB}/LICENSE ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/regxpcom ${MOB}/mozilla-bin ${MOZ}
@


1.2
log
@mozilla is and stays broken
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2003/04/13 02:40:48 david Exp $
d6 1
a6 1
VER=		1.4a
a10 2
BROKEN=		core dumps in dynamic library constructor

d20 1
a20 1
MASTER_SITES=	ftp://ftp.mozilla.org/pub/mozilla/releases/mozilla${VER}/src/
d22 4
d27 2
a28 2
LIB_DEPENDS=	gtk.1.2,gdk.1.2::x11/gtk+ \
		glib.1.2::devel/glib \
d43 5
a48 4
# disable this for now
#		--enable-crypto			\
# does not pass NSPR tests
#		--with-pthreads			\
a49 1
#		--disable-debug			\
a50 1
#		--disable-tests			\
d52 2
a53 1
CONFIGURE_ENV=	BSD_PTHREAD_LIBS="-pthread" \
d55 6
a60 3
MAKE_ENV=	LD_LIBRARY_PATH="${WRKSRC}/dist/bin" \
		CFLAGS="" CXXFLAGS="" \
		MALLOC_OPTIONS=j
d63 10
a72 8
	${INSTALL_DATA_DIR} ${PREFIX}/lib/mozilla
	@@chmod 755 ${PREFIX}/lib/mozilla
	@@cd ${WRKSRC}/dist/bin && ${TAR} -chf - . | \
		${TAR} -xf - -C ${PREFIX}/lib/mozilla
	${INSTALL_SCRIPT} ${WRKSRC}/dist/bin/mozilla ${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKSRC}/dist/bin/mozilla-bin ${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKSRC}/dist/bin/mozilla-config ${PREFIX}/bin
	${INSTALL_SCRIPT} ${WRKSRC}/dist/bin/run-mozilla.sh ${PREFIX}/bin
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.24 2002/12/29 15:03:57 fgsch Exp $
d4 1
a4 1
COMMENT=	"free version of the Netscape browser"
d6 1
a6 1
VER=		0.9.3
d15 2
d24 7
a30 7
#BUILD_DEPENDS=	zip:archivers/zip
#LIB_DEPENDS=	gtk.1.2::x11/gtk+ \
#		ORBit.2:devel/ORBit \
#		jpeg.9:graphics/jpeg \
#		png.4:graphics/png \
#		mng.1:graphics/libmng \
#		gdk-pixbuf.2:graphics/gdk-pixbuf
d37 13
a49 23
		--disable-cpp-exceptions	\
		--disable-cpp-rtti		\
		--disable-debug			\
		--disable-idltool		\
		--disable-md			\
		--disable-pedantic		\
		--disable-xterm-updates		\
		--enable-crypto			\
		--enable-double-buffer		\
		--enable-editor			\
		--enable-mailnews		\
		--enable-mathml			\
		--enable-optimize="${CFLAGS}"	\
		--enable-pics			\
		--enable-svg			\
		--enable-tests			\
		--enable-toolkit=gtk		\
		--enable-x11-shm		\
		--enable-chrome-format=jar	\
		--with-jpeg=${LOCALBASE}	\
		--with-png=${LOCALBASE}		\
		--with-mng=${LOCALBASE}		\
		--with-pthreads
d67 1
@


1.1.1.1
log
@Import OpenBSD 3.3 ports repository from CTM 3132 the first time
This continues opening an OpenBSD-mirabile (aka MirBSD) repository.

### MirBSD is:
# Copyright (c) 1982-2003 by Thorsten "mirabile" Glaser <x86@@ePost.de>
# Copyright © 1968-2003  The authors of And contributors to UNIX®, the
#       C Language, BSD/Berkeley Unix; 386BSD, NetBSD 1.1 and OpenBSD.
#
# Anyone who obtained a copy of this work is hereby permitted to freely use,
# distribute, modify, merge, sublicence, give away or sell it as long as the
# authors are given due credit and the following notice is retained:
#
# This work is provided "as is", with no explicit or implicit warranty what-
# soever. Use it only at your own risk. In no event may an author or contri-
# butor be held liable for any damage, directly or indirectly, that origina-
# ted through or is caused by creation or modification of this work.

MirBSD is my private tree. MirBSD does not differ very much from OpenBSD
and intentionally tracks OpenBSD. That's why it _is_ OpenBSD, just not the
official one. It's like with DarrenBSD.

At time of this writing, no advertising for MirBSD must be done,
because the advertising clause has not yet been sorted out.

http://templeofhate.com/tglaser/MirBSD/index.php
@
text
@@


1.1.1.2
log
@Import OpenBSD ports tree as of CTM delta 3200,
this time with:
| tg@@n1:/usr/OBSD/ports $ cvs -qd /lcvs import -I ! -I CVS ports openbsd-ports ctm-3200

This is necessary because of CVS shortcomings. The repository has been
manually prepared this time.

This is the last import to the ports tree before the release of
MirBSD#4 unless security issues appear.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.25 2003/04/13 02:40:48 david Exp $
d4 1
a4 1
COMMENT=	"open source version of the Netscape browser"
d6 1
a6 1
VER=		1.4a
a14 2
HOMEPAGE=	http://www.mozilla.org/

d22 7
a28 7
BUILD_DEPENDS=	:zip->=2.3:archivers/zip
LIB_DEPENDS=	gtk.1.2,gdk.1.2::x11/gtk+ \
		glib.1.2::devel/glib \
		IDL.4::devel/ORBit \
		jpeg.62::graphics/jpeg \
		png.3::graphics/png \
		mng.1::graphics/libmng
d35 23
a57 13
		--with-system-jpeg=${LOCALBASE}	\
		--with-system-mng=${LOCALBASE}	\
		--with-system-png=${LOCALBASE}	\
		--with-system-zlib=/usr/lib	\
		--disable-ldap
# disable this for now
#		--enable-crypto			\
# does not pass NSPR tests
#		--with-pthreads			\
# enable these once Mozilla actually runs
#		--disable-debug			\
#		--enable-optimize="${CFLAGS}"	\
#		--disable-tests			\
@


1.1.1.3
log
@Import OpenBSD-current ports tree
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.42 2003/05/18 20:41:19 wilfried Exp $
d6 1
a6 1
VER=		1.4b
d11 2
d22 1
a22 1
MASTER_SITES=	http://ftp.mozilla.org/pub/mozilla/releases/mozilla${VER}/src/
a23 4
MODULES=	iconv
MODULES+=	gcc3
MODGCC3_ARCHES=	sparc64
MODGCC3_LANGS=	C++
d25 2
a26 2
LIB_DEPENDS=	gtk.1,gdk.1::x11/gtk+ \
		glib.1,gmodule.1::devel/glib \
a40 5
		--with-pthreads			\
		--enable-crypto			\
		--disable-debug			\
		--disable-tests			\
		--disable-profilesharing	\
d42 4
d47 1
d49 1
d51 2
a52 1
CONFIGURE_ENV=	CFLAGS="" CXXFLAGS=""
d54 2
a55 7
		CFLAGS="" CXXFLAGS=""

MOB=		${WRKSRC}/dist/bin
MOZ=		${PREFIX}/mozilla

pre-configure:
	@@cd ${WRKSRC}/nsprpub && ${SETENV} ${AUTOCONF_ENV} ${AUTOCONF}
d58 8
a65 10
	${INSTALL_DATA_DIR} ${MOZ}
.for dir in chrome components defaults icons res plugins searchplugins
	@@cd ${MOB} && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
	@@cd ${MOB} && ${TAR} -chf - *.so.1.0 | \
		${TAR} -xf - -C ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/mozilla ${MOB}/run-mozilla.sh ${PREFIX}/bin
	${INSTALL_DATA} ${MOB}/LICENSE ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/regxpcom ${MOB}/mozilla-bin ${MOZ}
@


1.1.1.4
log
@Import latest OpenBSD CVS tree by CTM in order
to sync the base system and ports tree with Them.
@
text
@d1 2
a2 1
# $OpenBSD: Makefile,v 1.47 2003/06/02 07:05:56 pvalchev Exp $
a4 1
COMMENT-devel=	"devel files for Gecko"
d22 2
a23 12
MULTI_PACKAGES=	-devel

.for i in ${MULTI_PACKAGES}
PKGNAME$i=	mozilla${i}-${VER}
.endfor

SUBPACKAGE?=

.if ${SUBPACKAGE} == "-devel"
RUN_DEPENDS=	::www/mozilla
.else
MODULES=	gcc3
a32 1
.endif
a44 2
		--enable-extensions=default	\
		--disable-pedantic		\
d47 1
d49 2
d52 3
a54 2
CFLAGS+=	-fno-stack-protector
MAKE_ENV=	LD_LIBRARY_PATH="${WRKSRC}/dist/bin"
d56 1
a56 1
MOB=		${WRKSRC}/dist
d63 2
a64 2
.for dir in include lib
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
d68 1
a68 6
.for dir in chrome components defaults icons res plugins searchplugins
	${INSTALL_DATA_DIR} ${MOZ}/${dir}
	@@cd ${MOB}/bin && ${TAR} -chf - ${dir} | \
		${TAR} -xf - -C ${MOZ}
.endfor
	@@cd ${MOB}/bin && ${TAR} -chf - *.so.1.0 | \
d70 3
a72 4
	${INSTALL_DATA} ${MOB}/bin/LICENSE ${MOZ}
	${INSTALL_SCRIPT} ${MOB}/bin/mozilla ${PREFIX}/bin
	${INSTALL_SCRIPT} ${MOB}/bin/run-mozilla.sh ${MOZ}
	${INSTALL_PROGRAM} ${MOB}/bin/regxpcom ${MOB}/bin/mozilla-bin ${MOZ}
@


1.1.1.5
log
@Import OpenBSD CVS of roughly 2000-2200 UTC. Last import before release.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.48 2003/06/06 12:50:30 wilfried Exp $
d86 1
a86 1
	${INSTALL_SCRIPT} ${MOB}/bin/run-mozilla.sh ${MOB}/bin/mozilla-config ${MOZ}
@


1.1.1.6
log
@sync with the OpenBSD ports tree
note: this brings us new users (hint: /etc/master.passwd)
and other incompatibilities. Stay tuned.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.50 2003/06/25 12:01:16 wilfried Exp $
a69 2
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g' \
		${WRKSRC}/xpfe/bootstrap/mozilla.in
d87 1
a87 1
	${INSTALL_PROGRAM} ${MOB}/bin/regchrome ${MOB}/bin/regxpcom ${MOB}/bin/mozilla-bin ${MOZ}
@


1.1.1.7
log
@Import OpenBSD ports tree
@
text
@d1 1
a1 3
# $OpenBSD: Makefile,v 1.54 2003/07/04 06:59:15 marcm Exp $

NOT_FOR_ARCHS=	vax m68k hppa
d6 1
a6 1
VER=		1.4
a46 2
# Regression tests are too hard to adapt to run here
NO_REGRESS=	Yes
a89 6
	${INSTALL_DATA_DIR} ${PREFIX}/share/applications
	${INSTALL_DATA_DIR} ${PREFIX}/share/pixmaps
.for file in mozilla mozilla-mail mozilla-compose
	${INSTALL_DATA} ${WRKSRC}/build/package/rpm/SOURCES/${file}.desktop ${PREFIX}/share/applications
	${INSTALL_DATA} ${WRKSRC}/build/package/rpm/SOURCES/${file}-icon.* ${PREFIX}/share/pixmaps
.endfor
@


1.1.1.8
log
@Synchronize MirBSD ports tree with OpenBSD ports tree
Yields several updates and fixes, among them security ones
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.56 2003/07/17 08:24:24 wilfried Exp $
a25 2
VMEM_WARNING=yes

a70 3

post-extract:
	@@cp ${FILESDIR}/xptc* ${WRKSRC}/xpcom/reflect/xptcall/src/md/unix/
@


1.1.1.9
log
@Import latest OpenBSD ports, XFree and source in sync
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.57 2003/07/24 12:18:41 naddy Exp $
d38 1
a38 1
MODGCC3_ARCHES=	alpha sparc64
@


1.1.1.10
log
@Synchronize with OpenBSD 3.4-beta
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.58 2003/08/18 14:22:12 wilfried Exp $
d38 1
a38 1
MODGCC3_ARCHES=	alpha sparc64 powerpc
@


1.1.1.11
log
@Import OpenBSD 3.4-current ports tree.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.59 2003/09/03 17:35:47 pvalchev Exp $
d3 1
a3 1
NOT_FOR_ARCHS=	vax m68k hppa powerpc
@


1.1.1.12
log
@Import OpenBSD ports tree into MirPorts Framework
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.61 2003/10/18 19:44:47 sturm Exp $
d3 1
a3 1
ONLY_FOR_ARCHS= alpha i386 sparc sparc64
a16 1
# mozilla public license
@


1.1.1.13
log
@Now we can update MirPorts from OpenBSD ports tree again,
that we have fixed pkg_install tools accordingly in both
stable and current, and that these tools are compatible.

Consider MirPorts locked until next commit of ports/INDEX,v
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.62 2003/12/04 15:01:38 wilfried Exp $
d8 1
a8 1
VER=		1.6a
d46 2
a47 1
		png.3::graphics/png
d58 1
a105 2
	${INSTALL_DATA_DIR} ${PREFIX}/lib/pkgconfig
	${INSTALL_DATA} ${WRKBUILD}/build/unix/*.pc ${PREFIX}/lib/pkgconfig
@


1.1.1.14
log
@Import ports from OpenBSD CVS, 26.01.2004 17:25 CET
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.64 2004/01/19 14:36:48 wilfried Exp $
d8 1
a8 1
VER=		1.6
d41 1
a41 2
BUILD_DEPENDS=	:zip->=2.3:archivers/zip \
		:pkgconfig-*:devel/pkgconfig
a59 2
		--enable-xft			\
		--enable-optimize=-O2		\
a67 1
CONFIGURE_ENV=	PKG_CONFIG_PATH="${LOCALBASE}/lib/pkgconfig:${X11BASE}/lib/pkgconfig"
d78 1
a78 1
	@@perl -pi -e 's|_LOCALBASE_|${LOCALBASE}|g; s|_X11BASE_|${X11BASE}|g' \
@


1.1.1.15
log
@Import OpenBSD ports again. This will give us lots of new toys :).
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.66 2004/02/15 19:44:01 wilfried Exp $
d23 1
a23 2
MASTER_SITES=	http://ftp.eu.mozilla.org/pub/mozilla.org/mozilla/releases/mozilla${VER}/src/ \
		http://ftp.mozilla.org/pub/mozilla/releases/mozilla${VER}/src/
d39 1
a39 1
MODGCC3_ARCHES=	alpha sparc64
d62 1
a62 1
		--enable-optimize=-Os		\
d91 1
a91 3
	@@cd ${MOB}/public && ${TAR} -chf - nss | \
		${TAR} -xf - -C ${MOZ}/include
.for dir in chrome components defaults res searchplugins
a97 1
	@@chmod 444 ${MOZ}/*.so.1.0 ${MOZ}/components/*.so.1.0
@


1.1.1.16
log
@Import OpenBSD ports tree checked out from anoncvs.ca.openbsd.org at
2004-05-28 15:30 UTC.

Lots of SECURITY fixes, at least:

 * databases/mysql: tmpfile issue
 * www/squid: acl bypass
 * games/xonix: privilege escalation
 * archivers/lha: buffer overflow
 * mail/exim: buffer overflows
 * net/rsync: path checking issue
 * net/icecast: buffer overflow
 * www/opera
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.72 2004/05/06 14:39:49 wilfried Exp $
d3 1
a3 1
ONLY_FOR_ARCHS= alpha i386 sparc sparc64 amd64 powerpc
d40 1
a40 1
MODGCC3_ARCHES=	alpha powerpc
d45 1
d56 1
a56 2
AUTOCONF_VERSION= 2.13
CONFIGURE_STYLE= autoconf no-autoheader
a70 3
# There is no problem with the propolice-enabled gcc3 on amd64 and sparc64,
# but it is reported to still be broken on others.
.if ${MACHINE_ARCH} != "amd64" && ${MACHINE_ARCH} != "sparc64"
a71 2
.endif

@


